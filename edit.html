<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç·¨è¼¯åç‰‡ | Edit Business Card - UVACO</title>
  <link rel="stylesheet" href="styles.css">
  <!-- ä¸»é¡Œ CSS æª”æ¡ˆ -->
  <link rel="stylesheet" href="theme-1.css">
  <link rel="stylesheet" href="theme-2.css">
  <link rel="stylesheet" href="theme-3.css">
  <link rel="stylesheet" href="theme-4.css">
  <link rel="stylesheet" href="theme-5.css">
  <link rel="stylesheet" href="theme-6.css">
  <link rel="stylesheet" href="theme-7.css">
  <link rel="stylesheet" href="theme-8.css">
  <link rel="stylesheet" href="theme-9.css">
  <!-- Supabase JSï¼ˆCDNï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="cloud.js"></script>
  <style>
.edit-page-wrapper {
  padding-bottom: 100px;
}

/* =========================
   ä¸»é¡Œ UI è‰²å½©ç³»çµ±ï¼ˆç·¨è¼¯é å°ˆç”¨ï¼‰
   - ç›®çš„ï¼šä¸»é¡Œé¸æ“‡å™¨/å½ˆçª—/é ‚éƒ¨æ¬„ ç­‰ä»‹é¢å­—è‰²èˆ‡èƒŒæ™¯èƒ½éš¨ä¸»é¡Œå®Œæ•´è®Šæ›
   - ä»¥ body.card-theme-* ç‚ºæº–ï¼ˆç”± JS å¥—ç”¨ï¼‰
   ========================= */

/* é è¨­ï¼ˆæ·±è‰² / ä¸»é¡Œ1ï¼‰ */
body {
  --ui-header-bg: rgba(22, 22, 24, 0.95);
  --ui-header-border: rgba(255, 255, 255, 0.10);
  --ui-surface-bg: rgba(22, 22, 24, 0.98);
  --ui-surface-border: rgba(255, 255, 255, 0.10);
  --ui-text: #ffffff;
  --ui-muted: rgba(255, 255, 255, 0.75);
  --ui-field-bg: rgba(255, 255, 255, 0.08);
  --ui-field-border: rgba(255, 255, 255, 0.14);
  --ui-field-text: #ffffff;
  --ui-btn-muted-bg: rgba(255, 255, 255, 0.10);
  --ui-btn-muted-text: #ffffff;
  --ui-btn-muted-bg-hover: rgba(255, 255, 255, 0.18);
  --ui-overlay: rgba(0, 0, 0, 0.70);

  /* accentï¼ˆä¸»è‰²ï¼‰èˆ‡å…¶å°æ¯”æ–‡å­— */
  --ui-accent: #1faf53; /* é è¨­ç¶ ï¼ˆä¸»é¡Œ1ï¼‰ */
  --ui-accent-rgb: 31, 175, 83;
  --ui-accent-contrast: #0b1220; /* æ·±è‰²å­—ï¼ˆç”¨åœ¨æ·ºè‰² accent èƒŒæ™¯ï¼‰ */
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.12);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.20);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.70);

  /* é—œéµï¼šæŠŠèˆŠç³»çµ±çš„å“ç‰Œç¶ åœ¨ edit.html å…§æ”¹ç‚ºã€Œè·Ÿä¸»é¡Œ accent èµ°ã€ */
  --uvaco-green: var(--ui-accent);
}

/* æ·ºè‰²æ¨¡å¼åŸºç¤å‚™æ´ï¼ˆé¿å…ä¸»é¡Œé¡åˆ¥æœªåŠæ™‚è¼‰å…¥æ™‚å‡ºç¾ç™½å­—åœ¨æ·ºèƒŒæ™¯ï¼‰ */
body.theme-light {
  --ui-text: #111827;
  --ui-header-bg: #f3f4f6;
  --ui-surface-bg: rgba(255, 255, 255, 0.98);
  --ui-header-border: rgba(15, 23, 42, 0.12);
}

/* ä¸»é¡Œ2ï¼ˆæ·ºè‰²ï¼‰ */
body.card-theme-2 {
  --ui-header-bg: rgba(255, 255, 255, 0.95);
  --ui-header-border: rgba(15, 23, 42, 0.12);
  --ui-surface-bg: rgba(255, 255, 255, 0.98);
  --ui-surface-border: rgba(15, 23, 42, 0.12);
  --ui-text: #111827;
  --ui-muted: rgba(17, 24, 39, 0.70);
  --ui-field-bg: rgba(15, 23, 42, 0.04);
  --ui-field-border: rgba(15, 23, 42, 0.12);
  --ui-field-text: #111827;
  --ui-btn-muted-bg: rgba(15, 23, 42, 0.08);
  --ui-btn-muted-text: #111827;
  --ui-btn-muted-bg-hover: rgba(15, 23, 42, 0.14);
  --ui-overlay: rgba(0, 0, 0, 0.55);

  --ui-accent: #1faf53;
  --ui-accent-rgb: 31, 175, 83;
  --ui-accent-contrast: #0b1220;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.10);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.16);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.65);
}

/* ä¸»é¡Œ3ï¼ˆè—ï¼‰ */
body.card-theme-3 {
  --ui-header-bg: rgba(30, 58, 138, 0.95);
  --ui-header-border: rgba(255, 255, 255, 0.18);
  --ui-surface-bg: rgba(30, 58, 138, 0.98);
  --ui-surface-border: rgba(96, 165, 250, 0.35);
  --ui-text: #ffffff;
  --ui-muted: rgba(224, 231, 255, 0.85);
  --ui-field-bg: rgba(255, 255, 255, 0.10);
  --ui-field-border: rgba(255, 255, 255, 0.20);
  --ui-field-text: #ffffff;
  --ui-btn-muted-bg: rgba(255, 255, 255, 0.12);
  --ui-btn-muted-text: #ffffff;
  --ui-btn-muted-bg-hover: rgba(255, 255, 255, 0.20);
  --ui-overlay: rgba(0, 0, 0, 0.65);

  /* è—ä¸»é¡Œï¼šä½¿ç”¨æ·ºè—ä½œ accentï¼Œç¢ºä¿åœ¨æ·±è—èƒŒæ™¯å°æ¯”æ¸…æ¥š */
  --ui-accent: #60a5fa;
  --ui-accent-rgb: 96, 165, 250;
  --ui-accent-contrast: #1e3a8a;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.18);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.28);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.65);
}

/* ä¸»é¡Œ4ï¼ˆé‡‘ï¼‰ */
body.card-theme-4 {
  --ui-header-bg: rgba(180, 83, 9, 0.95);
  --ui-header-border: rgba(255, 255, 255, 0.20);
  --ui-surface-bg: rgba(180, 83, 9, 0.98);
  --ui-surface-border: rgba(251, 191, 36, 0.35);
  --ui-text: #ffffff;
  --ui-muted: rgba(254, 243, 199, 0.92);
  --ui-field-bg: rgba(255, 255, 255, 0.12);
  --ui-field-border: rgba(255, 255, 255, 0.22);
  --ui-field-text: #ffffff;
  --ui-btn-muted-bg: rgba(255, 255, 255, 0.14);
  --ui-btn-muted-text: #ffffff;
  --ui-btn-muted-bg-hover: rgba(255, 255, 255, 0.22);
  --ui-overlay: rgba(0,  0,  0, 0.65);

  /* é‡‘ä¸»é¡Œï¼šç”¨é‡‘è‰²ä½œ accentï¼Œæ–‡å­—ç”¨æ·±å’–æå‡å¯è®€æ€§ */
  --ui-accent: #fbbf24;
  --ui-accent-rgb: 251, 191, 36;
  --ui-accent-contrast: #78350f;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.18);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.28);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.70);
}

/* ä¸»é¡Œ5ï¼ˆç´«ï¼‰ */
body.card-theme-5 {
  --ui-header-bg: rgba(88, 28, 135, 0.95);
  --ui-header-border: rgba(255, 255, 255, 0.20);
  --ui-surface-bg: rgba(88, 28, 135, 0.98);
  --ui-surface-border: rgba(196, 181, 253, 0.35);
  --ui-text: #ffffff;
  --ui-muted: rgba(243, 232, 255, 0.92);
  --ui-field-bg: rgba(255, 255, 255, 0.12);
  --ui-field-border: rgba(255, 255, 255, 0.22);
  --ui-field-text: #ffffff;
  --ui-btn-muted-bg: rgba(255, 255, 255, 0.14);
  --ui-btn-muted-text: #ffffff;
  --ui-btn-muted-bg-hover: rgba(255, 255, 255, 0.22);
  --ui-overlay: rgba(0, 0, 0, 0.65);

  /* ç´«ä¸»é¡Œï¼šç”¨æ·¡ç´«ä½œ accentï¼Œæ·±ç´«åšå°æ¯”æ–‡å­— */
  --ui-accent: #a78bfa;
  --ui-accent-rgb: 167, 139, 250;
  --ui-accent-contrast: #581c87;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.18);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.28);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.70);
}

/* ä¸»é¡Œ6ï¼ˆæ·±é»‘ + ç¶“å…¸è—ï¼‰ */
body.card-theme-6 {
  --ui-header-bg: rgba(0, 0, 0, 0.95);
  --ui-header-border: rgba(255, 255, 255, 0.10);
  --ui-surface-bg: rgba(0, 0, 0, 0.98);
  --ui-surface-border: rgba(255, 255, 255, 0.12);
  --ui-text: #ffffff;
  --ui-muted: rgba(255, 255, 255, 0.80);
  --ui-field-bg: rgba(255, 255, 255, 0.10);
  --ui-field-border: rgba(255, 255, 255, 0.20);
  --ui-field-text: #ffffff;
  --ui-btn-muted-bg: rgba(255, 255, 255, 0.12);
  --ui-btn-muted-text: #ffffff;
  --ui-btn-muted-bg-hover: rgba(255, 255, 255, 0.20);
  --ui-overlay: rgba(0, 0, 0, 0.72);

  /* Classic Blue */
  --ui-accent: #0033A0;
  --ui-accent-rgb: 0, 51, 160;
  --ui-accent-contrast: #ffffff;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.16);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.26);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.72);
}

/* ä¸»é¡Œ7ï¼ˆç™½åº• + ç¶“å…¸è—ï¼‰ */
body.card-theme-7 {
  --ui-header-bg: rgba(255, 255, 255, 0.95);
  --ui-header-border: rgba(15, 23, 42, 0.12);
  --ui-surface-bg: rgba(255, 255, 255, 0.98);
  --ui-surface-border: rgba(15, 23, 42, 0.12);
  --ui-text: #111827;
  --ui-muted: rgba(17, 24, 39, 0.70);
  --ui-field-bg: rgba(15, 23, 42, 0.04);
  --ui-field-border: rgba(15, 23, 42, 0.12);
  --ui-field-text: #111827;
  --ui-btn-muted-bg: rgba(15, 23, 42, 0.08);
  --ui-btn-muted-text: #111827;
  --ui-btn-muted-bg-hover: rgba(15, 23, 42, 0.14);
  --ui-overlay: rgba(0, 0, 0, 0.55);

  /* Classic Blue */
  --ui-accent: #0033A0;
  --ui-accent-rgb: 0, 51, 160;
  --ui-accent-contrast: #ffffff;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.10);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.16);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.60);
}

/* ä¸»é¡Œ8ï¼ˆæ·±é»‘ + é’ç¶ ï¼‰ */
body.card-theme-8 {
  --ui-header-bg: rgba(0, 0, 0, 0.95);
  --ui-header-border: rgba(255, 255, 255, 0.10);
  --ui-surface-bg: rgba(0, 0, 0, 0.98);
  --ui-surface-border: rgba(255, 255, 255, 0.12);
  --ui-text: #ffffff;
  --ui-muted: rgba(255, 255, 255, 0.80);
  --ui-field-bg: rgba(255, 255, 255, 0.10);
  --ui-field-border: rgba(255, 255, 255, 0.20);
  --ui-field-text: #ffffff;
  --ui-btn-muted-bg: rgba(255, 255, 255, 0.12);
  --ui-btn-muted-text: #ffffff;
  --ui-btn-muted-bg-hover: rgba(255, 255, 255, 0.20);
  --ui-overlay: rgba(0, 0, 0, 0.72);

  /* Teal */
  --ui-accent: #00B7A9;
  --ui-accent-rgb: 0, 183, 169;
  --ui-accent-contrast: #001b18;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.16);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.26);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.72);
}

/* ä¸»é¡Œ9ï¼ˆç™½åº• + é’ç¶ ï¼‰ */
body.card-theme-9 {
  --ui-header-bg: rgba(255, 255, 255, 0.95);
  --ui-header-border: rgba(15, 23, 42, 0.12);
  --ui-surface-bg: rgba(255, 255, 255, 0.98);
  --ui-surface-border: rgba(15, 23, 42, 0.12);
  --ui-text: #111827;
  --ui-muted: rgba(17, 24, 39, 0.70);
  --ui-field-bg: rgba(15, 23, 42, 0.04);
  --ui-field-border: rgba(15, 23, 42, 0.12);
  --ui-field-text: #111827;
  --ui-btn-muted-bg: rgba(15, 23, 42, 0.08);
  --ui-btn-muted-text: #111827;
  --ui-btn-muted-bg-hover: rgba(15, 23, 42, 0.14);
  --ui-overlay: rgba(0, 0, 0, 0.55);

  /* Teal */
  --ui-accent: #00B7A9;
  --ui-accent-rgb: 0, 183, 169;
  --ui-accent-contrast: #001b18;
  --ui-accent-soft-bg: rgba(var(--ui-accent-rgb), 0.10);
  --ui-accent-soft-bg-hover: rgba(var(--ui-accent-rgb), 0.16);
  --ui-accent-border: rgba(var(--ui-accent-rgb), 0.60);
}

/* ===== ä¸»é¡Œä»‹é¢ï¼šå…±ç”¨æ–‡å­—/æŒ‰éˆ•é¡è‰²ï¼ˆè·Ÿä¸»é¡Œèµ°ï¼‰ ===== */

/* é ‚éƒ¨è¿”å›ç®­é ­ï¼ˆåŸæœ¬ inline ç¶å“ç‰Œç¶ ï¼Œé€™è£¡å¼·åˆ¶è·Ÿä¸»é¡Œ accent èµ°ï¼‰ */
.edit-top-header a {
  color: var(--ui-accent) !important;
}

/* æ¨™é¡Œï¼šæ”¹ç‚ºè·Ÿéš¨ä¸»é¡Œï¼ˆåœ¨æ·±è‰²ä¸»é¡Œç”¨ç™½å­—ï¼Œæ·ºè‰²ä¸»é¡Œç”¨æ·±å­—ï¼‰ */
.edit-header-top .edit-title {
  color: var(--ui-text) !important;
}

/* ä¸»é¡ŒæŒ‰éˆ• */
.edit-theme-btn {
  border-color: var(--ui-accent) !important;
  color: var(--ui-accent) !important;
  background: var(--ui-accent-soft-bg) !important;
}
.edit-theme-btn:hover {
  background: var(--ui-accent-soft-bg-hover) !important;
  border-color: var(--ui-accent) !important;
  color: var(--ui-accent) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25), 0 0 0 3px rgba(255,255,255,0.06);
}

/* å„²å­˜æŒ‰éˆ•ï¼šä½¿ç”¨ä¸»é¡Œ accent èƒŒæ™¯ï¼Œç¢ºä¿æ–‡å­—å°æ¯” */
.edit-save-btn {
  background: var(--ui-accent) !important;
  color: var(--ui-accent-contrast) !important;
}
.edit-save-btn:hover {
  filter: brightness(0.95);
  transform: translateY(-1px);
}

/* ä¸»é¡Œ/é€£çµè¼¸å…¥ç­‰å½ˆçª—æ¨™é¡Œï¼šç”¨ä¸»é¡Œ accentï¼ˆæ›´ç¬¦åˆä¸åŒä¸»é¡Œï¼‰ */
.theme-selector-title,
.link-input-title,
.contact-type-title,
.company-info-type-title,
.address-edit-title {
  color: var(--ui-accent) !important;
}

/* ===== å¡ç‰‡é è¦½å€ï¼ˆå…§å®¹æ–‡å­—/å¼·èª¿è‰²ï¼‰ ===== */

/* å¡ç‰‡å…§çš„è‹±æ–‡å `.en` èˆ‡ strongï¼šä¸å†å›ºå®šå“ç‰Œç¶ ï¼Œæ”¹è·Ÿä¸»é¡Œ accent */
#previewCard .name .en,
#previewCard .tagline strong {
  color: var(--ui-accent) !important;
}

/* å…¬å¸è³‡è¨Š label ä¹Ÿè·Ÿä¸»é¡Œ accentï¼ˆé¿å…è—/é‡‘/ç´«é‚„æ˜¯ç¶ ï¼‰ */
#previewCard .info-label,
#previewCard .address-map-link {
  color: var(--ui-accent) !important;
}

/* +æ–°å¢ æŒ‰éˆ•ï¼šè·Ÿä¸»é¡Œ accent */
.edit-add-btn {
  background: var(--ui-accent-soft-bg) !important;
  color: var(--ui-accent) !important;
  border: 1px solid var(--ui-accent-border) !important;
}
.edit-add-btn:hover {
  background: var(--ui-accent-soft-bg-hover) !important;
  border-color: var(--ui-accent) !important;
}

/* å›ºå®šé ‚éƒ¨å°èˆªæ¬„ */
.edit-top-header {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  width: 100% !important;
  z-index: 1000 !important;
  background: var(--ui-header-bg) !important;
  border-bottom: 1px solid var(--ui-header-border);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 20px;
  box-sizing: border-box;
}

body.theme-light .edit-top-header {
  background: #f3f4f6 !important;
  border-bottom-color: rgba(15, 23, 42, 0.1);
}

.edit-header-top {
  position: fixed !important;
  top: 44px !important; /* edit-top-header çš„é«˜åº¦ */
  left: 0 !important;
  right: 0 !important;
  width: 100% !important;
  z-index: 999 !important;
  background: var(--ui-header-bg) !important;
  border-bottom: 1px solid var(--ui-header-border);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  margin-bottom: 0;
  box-sizing: border-box;
}

body.theme-light .edit-header-top {
  border-bottom-color: rgba(15, 23, 42, 0.1);
  background: #f3f4f6 !important;
}

.edit-page-wrapper {
  padding-top: 120px; /* ç‚ºå…©å€‹å›ºå®šé ‚éƒ¨æ¬„ç•™å‡ºç©ºé–“ (44px + 60px + 16px) */
}

/* ä¸»é¡Œé¸æ“‡æŒ‰éˆ• */
.edit-theme-btn {
  display: flex !important;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 8px 14px;
  border: 2px solid var(--uvaco-green);
  border-radius: 8px;
  color: var(--uvaco-green);
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s;
  white-space: nowrap;
  background: rgba(var(--ui-accent-rgb), 0.12);
  min-width: auto;
  height: auto;
}

body.theme-dark .edit-theme-btn {
  background: rgba(var(--ui-accent-rgb), 0.12);
  color: var(--uvaco-green);
  border-color: var(--uvaco-green);
}

body.theme-light .edit-theme-btn {
  background: rgba(var(--ui-accent-rgb), 0.12);
  color: var(--uvaco-green);
  border-color: var(--uvaco-green);
}

.edit-theme-btn:hover {
  background: rgba(var(--ui-accent-rgb), 0.20) !important;
  border-color: var(--uvaco-green) !important;
  color: var(--uvaco-green) !important;
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(var(--ui-accent-rgb), 0.35);
}

body.theme-light .edit-theme-btn:hover {
  background: rgba(var(--ui-accent-rgb), 0.20) !important;
}

/* ä¸»é¡Œé¸æ“‡å™¨æ¨¡æ…‹æ¡† */
.theme-selector-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--ui-overlay);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 5000;
  display: none;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease;
}

.theme-selector-overlay.show {
  display: flex;
}

.theme-selector-modal {
  width: 90%;
  max-width: 800px;
  max-height: 85vh;
  border-radius: 24px;
  padding: 32px;
  animation: slideUp 0.3s ease;
  position: relative;
  overflow-y: auto;
}

/* ä½¿ç”¨ä¸»é¡Œè®Šæ•¸ï¼Œè®“ 1~5 éƒ½æœ‰ä¸€è‡´ä¸”å¯è®€çš„ UI é…è‰² */
.theme-selector-modal {
  background: var(--ui-surface-bg);
  border: 1px solid var(--ui-surface-border);
  color: var(--ui-text);
}

.theme-selector-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.theme-selector-title {
  font-size: 24px;
  font-weight: 700;
  color: var(--uvaco-green);
  margin: 0;
}

.theme-selector-close {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: var(--ui-btn-muted-bg);
  border: none;
  color: var(--ui-btn-muted-text);
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

body.theme-light .theme-selector-close {
  background: rgba(15, 23, 42, 0.1);
  color: #111827;
}

.theme-selector-close:hover {
  background: rgba(239, 68, 68, 0.2);
  color: #ef4444;
  transform: rotate(90deg);
}

.theme-selector-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}

.theme-card-preview {
  cursor: pointer;
  border-radius: 16px;
  overflow: hidden;
  transition: all 0.3s;
  border: 3px solid transparent;
  position: relative;
}

.theme-card-preview:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 24px rgba(0,0,0,0.3);
}

.theme-card-preview.active {
  border-color: var(--uvaco-green);
  box-shadow: 0 0 0 4px rgba(var(--ui-accent-rgb), 0.30);
}

.theme-card-preview.active::after {
  content: 'âœ“';
  position: absolute;
  top: 12px;
  right: 12px;
  width: 32px;
  height: 32px;
  background: var(--uvaco-green);
  color: #ffffff;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 700;
  box-shadow: 0 4px 12px rgba(var(--ui-accent-rgb), 0.38);
}

.theme-preview-wrapper {
  width: 100%;
  aspect-ratio: 3 / 4;
  display: flex;
  flex-direction: column;
  padding: 16px;
  gap: 12px;
}

.theme-preview-top-bar {
  height: 32px;
  border-radius: 8px;
  opacity: 0.9;
}

.theme-preview-card {
  flex: 1;
  border-radius: 12px;
  opacity: 0.85;
  display: flex;
  flex-direction: column;
  padding: 16px;
  gap: 8px;
}

.theme-preview-text {
  height: 12px;
  border-radius: 4px;
  opacity: 0.6;
}

.theme-preview-text.long {
  width: 80%;
}

.theme-preview-text.short {
  width: 50%;
}

.theme-preview-button {
  height: 36px;
  border-radius: 8px;
  opacity: 0.9;
  margin-top: auto;
}

.theme-card-name {
  text-align: center;
  padding: 12px;
  font-size: 15px;
  font-weight: 600;
}

.theme-card-name { color: var(--ui-text); }

/* ä¸»é¡Œ 1ï¼šæ·±è‰² */
.theme-card-preview[data-theme="1"] .theme-preview-wrapper {
  background: #050608;
}
.theme-card-preview[data-theme="1"] .theme-preview-top-bar {
  background: rgba(22, 22, 24, 0.95);
}
.theme-card-preview[data-theme="1"] .theme-preview-card {
  background: rgba(22,22,24,0.85);
}
.theme-card-preview[data-theme="1"] .theme-preview-text {
  background: rgba(255,255,255,0.3);
}
.theme-card-preview[data-theme="1"] .theme-preview-button {
  background: var(--uvaco-green);
}

/* ä¸»é¡Œ 2ï¼šæ·ºè‰² */
.theme-card-preview[data-theme="2"] .theme-preview-wrapper {
  background: #f3f4f6;
}
.theme-card-preview[data-theme="2"] .theme-preview-top-bar {
  background: rgba(255, 255, 255, 0.95);
}
.theme-card-preview[data-theme="2"] .theme-preview-card {
  background: #ffffff;
}
.theme-card-preview[data-theme="2"] .theme-preview-text {
  background: rgba(0,0,0,0.15);
}
.theme-card-preview[data-theme="2"] .theme-preview-button {
  background: var(--uvaco-green);
}

/* ä¸»é¡Œ 3ï¼šè—è‰² */
.theme-card-preview[data-theme="3"] .theme-preview-wrapper {
  background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 50%, #3b82f6 100%);
}
.theme-card-preview[data-theme="3"] .theme-preview-top-bar {
  background: rgba(30, 58, 138, 0.95);
}
.theme-card-preview[data-theme="3"] .theme-preview-card {
  background: rgba(30,58,138,0.85);
}
.theme-card-preview[data-theme="3"] .theme-preview-text {
  background: rgba(255,255,255,0.3);
}
.theme-card-preview[data-theme="3"] .theme-preview-button {
  background: #60a5fa;
}

/* ä¸»é¡Œ 4ï¼šé‡‘è‰² */
.theme-card-preview[data-theme="4"] .theme-preview-wrapper {
  background: linear-gradient(135deg, #b45309 0%, #d97706 50%, #f59e0b 100%);
}
.theme-card-preview[data-theme="4"] .theme-preview-top-bar {
  background: rgba(180, 83, 9, 0.95);
}
.theme-card-preview[data-theme="4"] .theme-preview-card {
  background: rgba(180,83,9,0.85);
}
.theme-card-preview[data-theme="4"] .theme-preview-text {
  background: rgba(255,255,255,0.3);
}
.theme-card-preview[data-theme="4"] .theme-preview-button {
  background: #fbbf24;
}

/* ä¸»é¡Œ 5ï¼šç´«è‰² */
.theme-card-preview[data-theme="5"] .theme-preview-wrapper {
  background: linear-gradient(135deg, #581c87 0%, #7c3aed 50%, #9333ea 100%);
}
.theme-card-preview[data-theme="5"] .theme-preview-top-bar {
  background: rgba(88, 28, 135, 0.95);
}
.theme-card-preview[data-theme="5"] .theme-preview-card {
  background: rgba(88,28,135,0.85);
}
.theme-card-preview[data-theme="5"] .theme-preview-text {
  background: rgba(255,255,255,0.3);
}
.theme-card-preview[data-theme="5"] .theme-preview-button {
  background: #a78bfa;
}

/* ä¸»é¡Œ 6ï¼šæ·±é»‘ + ç¶“å…¸è— */
.theme-card-preview[data-theme="6"] .theme-preview-wrapper {
  background: #000000;
}
.theme-card-preview[data-theme="6"] .theme-preview-top-bar {
  background: rgba(0, 0, 0, 0.95);
}
.theme-card-preview[data-theme="6"] .theme-preview-card {
  background: rgba(10,10,12,0.90);
}
.theme-card-preview[data-theme="6"] .theme-preview-text {
  background: rgba(255,255,255,0.30);
}
.theme-card-preview[data-theme="6"] .theme-preview-button {
  background: #0033A0;
}

/* ä¸»é¡Œ 7ï¼šç™½åº• + ç¶“å…¸è— */
.theme-card-preview[data-theme="7"] .theme-preview-wrapper {
  background: #ffffff;
}
.theme-card-preview[data-theme="7"] .theme-preview-top-bar {
  background: rgba(255, 255, 255, 0.95);
}
.theme-card-preview[data-theme="7"] .theme-preview-card {
  background: #ffffff;
  border: 1px solid rgba(15,23,42,0.08);
}
.theme-card-preview[data-theme="7"] .theme-preview-text {
  background: rgba(15,23,42,0.14);
}
.theme-card-preview[data-theme="7"] .theme-preview-button {
  background: #0033A0;
}

/* ä¸»é¡Œ 8ï¼šæ·±é»‘ + é’ç¶  */
.theme-card-preview[data-theme="8"] .theme-preview-wrapper {
  background: #000000;
}
.theme-card-preview[data-theme="8"] .theme-preview-top-bar {
  background: rgba(0, 0, 0, 0.95);
}
.theme-card-preview[data-theme="8"] .theme-preview-card {
  background: rgba(10,10,12,0.90);
}
.theme-card-preview[data-theme="8"] .theme-preview-text {
  background: rgba(255,255,255,0.30);
}
.theme-card-preview[data-theme="8"] .theme-preview-button {
  background: #00B7A9;
}

/* ä¸»é¡Œ 9ï¼šç™½åº• + é’ç¶  */
.theme-card-preview[data-theme="9"] .theme-preview-wrapper {
  background: #ffffff;
}
.theme-card-preview[data-theme="9"] .theme-preview-top-bar {
  background: rgba(255, 255, 255, 0.95);
}
.theme-card-preview[data-theme="9"] .theme-preview-card {
  background: #ffffff;
  border: 1px solid rgba(15,23,42,0.08);
}
.theme-card-preview[data-theme="9"] .theme-preview-text {
  background: rgba(15,23,42,0.14);
}
.theme-card-preview[data-theme="9"] .theme-preview-button {
  background: #00B7A9;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* å¯ç·¨è¼¯å…ƒç´ æ¨£å¼ */
.edit-clickable {
  cursor: pointer;
  transition: all 0.2s;
}

/* åªæœ‰éçµ•å°å®šä½çš„å…ƒç´ æ‰è¨­ç½® relative */
.edit-clickable:not(.avatar):not([style*="position: absolute"]) {
  position: relative;
}

.edit-clickable:hover {
  opacity: 0.8;
  outline: 2px dashed var(--uvaco-green);
  outline-offset: 4px;
}

/* ç¢ºä¿é ­åƒä¿æŒçµ•å°å®šä½ */
.avatar.edit-clickable {
  position: absolute !important;
  top: 14px !important;
  right: 16px !important;
  width: 104px !important;
  height: 104px !important;
  border-radius: 50% !important;
  object-fit: cover !important;
}

.edit-clickable[contenteditable="true"] {
  outline: none;
  padding: 2px 4px;
  border-radius: 4px;
}

.edit-clickable[contenteditable="true"]:focus {
  outline: 2px solid var(--uvaco-green);
  outline-offset: 2px;
  background: rgba(var(--ui-accent-rgb), 0.12);
}

/* æ¨™èªå®¹å™¨å’Œåˆªé™¤æŒ‰éˆ• */
.slogans-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.slogan-item {
  position: relative;
  display: flex;
  align-items: center;
  gap: 8px;
}

.slogan-delete-btn {
  display: none;
  padding: 4px 8px;
  background: rgba(239, 68, 68, 0.1);
  color: #ef4444;
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
  flex-shrink: 0;
}

.slogan-item:hover .slogan-delete-btn {
  display: block;
}

.slogan-delete-btn:hover {
  background: rgba(239, 68, 68, 0.2);
}

/* é è¦½å€åŸŸå±…ä¸­ - åŠ å¤§å¯¬åº¦ä»¥æ”¯æŒæ©«å‘æ’åˆ— */
.edit-preview-section {
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
}

/* å¡ç‰‡ä¹ŸåŠ å¤§å¯¬åº¦ */
.edit-preview-section .card {
  max-width: 1200px;
  width: 100%;
  padding: 26px 150px 26px 22px; /* å³å´ç•™ç©ºçµ¦é ­åƒ */
}

/* æŒ‰éˆ•ç¾¤çµ„å‚ç›´æ’åˆ— */
.edit-preview-section .btn-group {
  display: flex;
  flex-direction: column;
  gap: 12px;
  width: 100%;
}

/* è¯çµ¡æ–¹å¼æŒ‰éˆ•å‚ç›´æ’åˆ— */
.edit-preview-section .contact-btn-wrapper {
  width: 100%;
  flex: 0 0 auto;
}

/* æŒ‰éˆ•å¯¬åº¦è‡ªé©æ‡‰ */
.edit-preview-section .btn {
  width: 100%;
  white-space: nowrap;
  justify-content: flex-start;
  padding-left: 16px;
}

/* æ–°å¢æŒ‰éˆ•å‚ç›´æ’åˆ— */
.edit-preview-section .edit-add-btn {
  width: 100% !important;
  margin-top: 8px !important;
}

/* æ¨™èªå®¹å™¨æ©«å‘æ’åˆ— */
.edit-preview-section .slogans-container {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}

.edit-preview-section .slogan-item {
  width: auto;
  flex: 0 0 auto;
  min-width: 200px;
  max-width: 350px;
}

/* æ¨™é¡Œå’Œæ¨™èªå€åŸŸæ©«å‘ä½ˆå±€ */
.edit-preview-section .name,
.edit-preview-section .tagline,
.edit-preview-section .section-label {
  display: inline-block;
  margin-right: 16px;
}

/* æç¤ºæ–‡å­—æ©«å‘æ’åˆ— */
.edit-preview-section .hint {
  max-width: 600px;
  display: inline-block;
}

/* è¯çµ¡æ–¹å¼æŒ‰éˆ•åŒ…è£å™¨ */
.contact-btn-wrapper {
  position: relative;
  width: 100%;
}

.contact-delete-btn {
  display: none;
  position: absolute;
  top: 8px;
  right: 8px;
  padding: 4px 8px;
  background: rgba(239, 68, 68, 0.9);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  z-index: 10;
  transition: all 0.2s;
}

.contact-btn-wrapper:hover .contact-delete-btn {
  display: block;
}

.contact-delete-btn:hover {
  background: rgba(239, 68, 68, 1);
}

/* é€£çµè¼¸å…¥æ¨¡æ…‹æ¡†æ¨£å¼ */
.link-input-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: var(--ui-overlay);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 4000 !important;
  display: none;
  align-items: center !important;
  justify-content: center !important;
  animation: fadeIn 0.3s ease;
}

.link-input-overlay.show {
  display: flex !important;
}

.link-input-modal {
  width: 90%;
  max-width: 400px;
  border-radius: 20px;
  padding: 24px;
  animation: slideUp 0.3s ease;
  position: relative;
  margin: auto;
}

.link-input-modal {
  background: var(--ui-surface-bg);
  border: 1px solid var(--ui-surface-border);
  color: var(--ui-text);
}

.link-input-title {
  font-size: 20px;
  font-weight: 700;
  color: var(--uvaco-green);
  text-align: center;
  margin-bottom: 20px;
}

.link-input-field {
  width: 100%;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid var(--ui-field-border);
  background: var(--ui-field-bg);
  color: var(--ui-field-text);
  font-size: 16px;
  margin-bottom: 20px;
  box-sizing: border-box;
}

body.theme-light .link-input-field {
  border-color: rgba(15, 23, 42, 0.1);
  background: rgba(15, 23, 42, 0.03);
  color: #111827;
}

.link-input-field:focus {
  outline: none;
  border-color: var(--uvaco-green);
  background: rgba(var(--ui-accent-rgb), 0.12);
}

.link-input-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

.link-input-btn {
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.link-input-cancel {
  background: var(--ui-btn-muted-bg);
  color: var(--ui-btn-muted-text);
}

body.theme-light .link-input-cancel {
  background: rgba(15, 23, 42, 0.1);
  color: #111827;
}

.link-input-cancel:hover {
  background: var(--ui-btn-muted-bg-hover);
}

body.theme-light .link-input-cancel:hover {
  background: rgba(15, 23, 42, 0.2);
}

.link-input-submit {
  background: var(--uvaco-green);
  color: #ffffff;
}

.link-input-submit:hover {
  background: #1fa05a;
  transform: translateY(-1px);
}

/* è‡ªè¨‚é¡å‹ï¼ˆå…¶ä»–ï¼‰æ¨¡æ…‹æ¡† */
.custom-type-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: var(--ui-overlay);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 4500 !important;
  display: none;
  align-items: center !important;
  justify-content: center !important;
}

.custom-type-overlay.show {
  display: flex !important;
}

.custom-type-modal {
  width: 92%;
  max-width: 420px;
  border-radius: 20px;
  padding: 24px;
  background: var(--ui-surface-bg);
  border: 1px solid var(--ui-surface-border);
  color: var(--ui-text);
}

.custom-type-title {
  font-size: 18px;
  font-weight: 800;
  margin: 0 0 16px 0;
  color: var(--ui-accent);
}

.custom-type-label {
  font-size: 13px;
  font-weight: 700;
  margin-bottom: 6px;
  color: var(--ui-muted);
}

.custom-type-field {
  width: 100%;
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid var(--ui-field-border);
  background: var(--ui-field-bg);
  color: var(--ui-field-text);
  font-size: 15px;
  box-sizing: border-box;
  margin-bottom: 12px;
}

.custom-type-field:focus {
  outline: none;
  border-color: var(--ui-accent);
  box-shadow: 0 0 0 3px rgba(var(--ui-accent-rgb), 0.18);
}

.custom-type-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 8px;
}

.custom-type-btn {
  padding: 10px 18px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-weight: 700;
  transition: all 0.2s;
}

.custom-type-cancel {
  background: var(--ui-btn-muted-bg);
  color: var(--ui-btn-muted-text);
}

.custom-type-cancel:hover {
  background: var(--ui-btn-muted-bg-hover);
}

.custom-type-confirm {
  background: var(--ui-accent);
  color: var(--ui-accent-contrast);
}

.custom-type-confirm:hover {
  filter: brightness(0.96);
  transform: translateY(-1px);
}
/* ===== æ¨¡æ…‹æ¡†å…±ç”¨æ»¾å‹•èˆ‡é…è‰²å„ªåŒ– ===== */
.contact-type-modal,
.link-input-modal,
.custom-type-modal,
.company-info-type-modal,
.address-edit-modal {
  max-height: 85vh;
  overflow-y: auto;
  scrollbar-width: thin;
  -webkit-overflow-scrolling: touch; /* iOS æ»¾å‹•å„ªåŒ– */
}

/* æ²è»¸ç¾åŒ– */
.contact-type-modal::-webkit-scrollbar,
.link-input-modal::-webkit-scrollbar,
.custom-type-modal::-webkit-scrollbar,
.company-info-type-modal::-webkit-scrollbar,
.address-edit-modal::-webkit-scrollbar {
  width: 6px;
}

.contact-type-modal::-webkit-scrollbar-thumb,
.link-input-modal::-webkit-scrollbar-thumb,
.custom-type-modal::-webkit-scrollbar-thumb,
.company-info-type-modal::-webkit-scrollbar-thumb,
.address-edit-modal::-webkit-scrollbar-thumb {
  background: var(--ui-accent);
  border-radius: 10px;
}

.contact-type-modal::-webkit-scrollbar-track,
.link-input-modal::-webkit-scrollbar-track,
.custom-type-modal::-webkit-scrollbar-track,
.company-info-type-modal::-webkit-scrollbar-track,
.address-edit-modal::-webkit-scrollbar-track {
  background: var(--ui-btn-muted-bg);
}

/* è¯çµ¡æ–¹å¼é¡å‹é¸æ“‡å½ˆçª—å°ˆå±¬æ¨£å¼ */
.contact-type-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: var(--ui-overlay);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 3500 !important; /* ç¢ºä¿åœ¨å…¶ä»– UI ä¹‹ä¸‹ï¼Œä½†åœ¨èƒŒæ™¯ä¹‹ä¸Š */
  display: none;
  align-items: center !important;
  justify-content: center !important;
  animation: fadeIn 0.3s ease;
}

.contact-type-overlay.show {
  display: flex !important;
}

.contact-type-modal {
  width: 92%;
  max-width: 500px;
  border-radius: 24px;
  padding: 32px;
  background: var(--ui-surface-bg);
  border: 1px solid var(--ui-surface-border);
  color: var(--ui-text);
  animation: slideUp 0.3s ease;
  position: relative;
}

.contact-type-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

@media (max-width: 480px) {
  .contact-type-grid {
    grid-template-columns: repeat(2, 1fr); /* æ‰‹æ©Ÿç«¯æ”¹ç‚º 2 æ¬„ä½ï¼Œé»æ“Šå€åŸŸæ›´å¤§ */
    gap: 12px;
  }
  .contact-type-modal {
    padding: 24px 16px;
  }
}

.contact-type-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 16px 8px;
  background: var(--ui-btn-muted-bg);
  border: 1px solid var(--ui-surface-border);
  border-radius: 16px;
  color: var(--ui-text);
  cursor: pointer;
  transition: all 0.2s;
  gap: 10px;
}

.contact-type-btn:hover {
  background: var(--ui-btn-muted-bg-hover);
  border-color: var(--ui-accent);
  transform: translateY(-2px);
}

.contact-type-icon {
  font-size: 24px;
}

.contact-type-icon-img {
  width: 32px;
  height: 32px;
  object-fit: contain;
}

.contact-type-label {
  font-size: 13px;
  font-weight: 600;
  text-align: center;
}

/* å…¬å¸è³‡è¨Šé¡å‹å½ˆçª—å°ˆå±¬æ¨£å¼ */
.company-info-type-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: var(--ui-overlay);
  backdrop-filter: blur(8px);
  z-index: 3600 !important;
  display: none;
  align-items: center !important;
  justify-content: center !important;
}

.company-info-type-overlay.show {
  display: flex !important;
}

.company-info-type-modal {
  width: 92%;
  max-width: 450px;
  border-radius: 24px;
  padding: 32px;
  background: var(--ui-surface-bg);
  border: 1px solid var(--ui-surface-border);
  color: var(--ui-text);
  animation: slideUp 0.3s ease;
}

.company-info-type-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.company-info-type-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 20px;
  background: var(--ui-btn-muted-bg);
  border: 1px solid var(--ui-surface-border);
  border-radius: 16px;
  color: var(--ui-text);
  cursor: pointer;
  transition: all 0.2s;
}

.company-info-type-btn:hover {
  background: var(--ui-btn-muted-bg-hover);
  border-color: var(--ui-accent);
  transform: translateY(-2px);
}

.company-info-type-icon {
  font-size: 28px;
}

.company-info-type-label {
  font-size: 14px;
  font-weight: 700;
}

/* åœ°å€ç·¨è¼¯å½ˆçª—å°ˆå±¬æ¨£å¼ */
.address-edit-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: var(--ui-overlay);
  backdrop-filter: blur(8px);
  z-index: 3700 !important;
  display: none;
  align-items: center !important;
  justify-content: center !important;
}

.address-edit-overlay.show {
  display: flex !important;
}

.address-edit-modal {
  width: 92%;
  max-width: 500px;
  border-radius: 24px;
  padding: 32px;
  background: var(--ui-surface-bg);
  border: 1px solid var(--ui-surface-border);
  color: var(--ui-text);
}

.address-edit-textarea {
  width: 100%;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid var(--ui-field-border);
  background: var(--ui-field-bg);
  color: var(--ui-field-text);
  font-size: 15px;
  resize: vertical;
  margin-bottom: 16px;
  box-sizing: border-box;
}

.address-edit-textarea:focus {
  outline: none;
  border-color: var(--ui-accent);
}

.address-edit-label {
  display: block;
  font-size: 13px;
  font-weight: 700;
  margin-bottom: 8px;
  color: var(--ui-muted);
}

.address-edit-btn {
  padding: 12px 24px;
  border-radius: 12px;
  border: none;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
}

.address-edit-submit {
  background: var(--ui-accent);
  color: var(--ui-accent-contrast);
}

.address-edit-cancel {
  background: var(--ui-btn-muted-bg);
  color: var(--ui-btn-muted-text);
}

.address-edit-actions {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  margin-top: 20px;
}

</style>
</head>

<body class="lang-zh">

<!-- èƒŒæ™¯æ³¡æ³¡ -->
<div class="bg-blob blob1"></div>
<div class="bg-blob blob2"></div>

<!-- é ‚éƒ¨ï¼šè¿”å›æŒ‰éˆ• -->
<div class="edit-top-header">
  <a href="yuyuko.html" style="font-size: 20px; color: var(--uvaco-green); text-decoration: none;">â†</a>
</div>

<div class="edit-page-wrapper">
  <div class="edit-page-container">
    <!-- é ‚éƒ¨ï¼šæ¨™é¡Œå’Œä¿å­˜æŒ‰éˆ• -->
    <div class="edit-header-top">
      <h1 class="edit-title lang-zh">ç·¨è¼¯åç‰‡</h1>
      <h1 class="edit-title lang-en">Edit Business Card</h1>
      <div style="display: flex; gap: 12px; align-items: center;">
        <button class="edit-theme-btn" onclick="showThemeSelector()" title="é¸æ“‡ä¸»é¡Œ">
          <span style="font-size: 18px;">ğŸ¨</span>
          <span class="lang-zh">ä¸»é¡Œ</span>
          <span class="lang-en">Theme</span>
        </button>
        <button class="edit-save-btn" onclick="saveCard()">
          <span class="lang-zh">å„²å­˜</span>
          <span class="lang-en">Save</span>
        </button>
      </div>
    </div>
    
    
    <!-- åç‰‡é è¦½ï¼ˆå¯ç›´æ¥ç·¨è¼¯ï¼‰ -->
    <div class="edit-preview-section">
      <div class="hero">
        <div class="hero-frame edit-clickable" onclick="editLogo()" title="é»æ“Šç·¨è¼¯ LOGO">
          <img src="uvaco-logo.svg" class="hero-logo" alt="UVACO" id="previewLogo">
        </div>
      </div>

      <div class="card" id="previewCard" style="position: relative; padding-right: 150px;">
        <img class="avatar edit-clickable" id="previewAvatar" src="default-avatar.svg" alt="Avatar" loading="lazy" onclick="editAvatar()" title="é»æ“Šç·¨è¼¯é ­åƒ">
        
        <div class="name lang-zh edit-clickable" id="previewNameZh" contenteditable="true" onblur="updateNameFromPreview()" onclick="focusEdit(this)">æŸ¯å®œç€… ï½œ <span class="en">Yuyu Ko</span></div>
        <div class="name lang-en edit-clickable" id="previewNameEn" contenteditable="true" onblur="updateNameFromPreview()" onclick="focusEdit(this)">Yuyu Ko ï½œ <span class="en">Ko</span></div>
        
        <div class="tagline lang-zh edit-clickable" id="previewTitleZh" contenteditable="true" onblur="updateTitleFromPreview()" onclick="focusEdit(this)">æ¥­å‹™ç¶“ç†</div>
        <div class="tagline lang-en edit-clickable" id="previewTitleEn" contenteditable="true" onblur="updateTitleFromPreview()" onclick="focusEdit(this)">Sales Manager</div>
        
        <div style="display: flex; flex-wrap: wrap; gap: 12px; align-items: flex-start;">
          <div id="previewSlogansZh" class="slogans-container">
            <div class="slogan-item">
              <div class="tagline lang-zh edit-clickable" contenteditable="true" onblur="updateSlogansPreview()" onclick="focusEdit(this)">å¥åº·ãƒ»äº‹æ¥­ãƒ»æœªä¾†</div>
              <button class="slogan-delete-btn" onclick="deleteSloganFromPreview(this)" title="åˆªé™¤æ¨™èª">âœ•</button>
            </div>
            <div class="slogan-item">
              <div class="tagline lang-zh edit-clickable" contenteditable="true" onblur="updateSlogansPreview()" onclick="focusEdit(this)"><strong>è‘¡çœ¾ä¼æ¥­ï½œå°ˆæ¥­é™ªä¼´</strong></div>
              <button class="slogan-delete-btn" onclick="deleteSloganFromPreview(this)" title="åˆªé™¤æ¨™èª">âœ•</button>
            </div>
          </div>
          <button class="edit-add-btn lang-zh" onclick="addSloganToPreview('zh')">+ æ–°å¢ä¸­æ–‡æ¨™èª</button>
          <button class="edit-add-btn lang-en" onclick="addSloganToPreview('zh')">+ Add Chinese Slogan</button>
          
          <div id="previewSlogansEn" class="slogans-container">
            <div class="slogan-item">
              <div class="tagline lang-en edit-clickable" contenteditable="true" onblur="updateSlogansPreview()" onclick="focusEdit(this)">Health â€¢ Business â€¢ Future</div>
              <button class="slogan-delete-btn" onclick="deleteSloganFromPreview(this)" title="Delete slogan">âœ•</button>
            </div>
            <div class="slogan-item">
              <div class="tagline lang-en edit-clickable" contenteditable="true" onblur="updateSlogansPreview()" onclick="focusEdit(this)"><strong>Puzhong Enterprise | Professional Support</strong></div>
              <button class="slogan-delete-btn" onclick="deleteSloganFromPreview(this)" title="Delete slogan">âœ•</button>
            </div>
          </div>
          <button class="edit-add-btn lang-zh" onclick="addSloganToPreview('en')">+ æ–°å¢è‹±æ–‡æ¨™èª</button>
          <button class="edit-add-btn lang-en" onclick="addSloganToPreview('en')">+ Add English Slogan</button>
        </div>

        <div class="divider"></div>

        <!-- å…¬å¸è³‡è¨Šå€å¡Š -->
        <div class="company-info-section" id="companyInfoSection">
          <div class="section-label lang-zh">å…¬å¸è³‡è¨Š COMPANY INFO</div>
          <div class="section-label lang-en">COMPANY INFO</div>
          
          <!-- çµ±ä¸€ç·¨è™Ÿï¼ˆå¯é¸ï¼‰ -->
          <div class="info-item info-item-tax" id="taxIdItem" style="display: none;">
            <span class="info-label lang-zh">çµ±ä¸€ç·¨è™Ÿï¼š</span>
            <span class="info-label lang-en">Tax ID:</span>
            <span class="info-value lang-zh edit-clickable" id="previewTaxIdZh" contenteditable="true" onclick="editTaxId(event)">12345678</span>
            <span class="info-value lang-en edit-clickable" id="previewTaxIdEn" contenteditable="true" onclick="editTaxId(event)">12345678</span>
            <button class="info-delete-btn" onclick="deleteCompanyInfo('taxId')" title="åˆªé™¤">Ã—</button>
          </div>
          
          <!-- æœå‹™æ“šé»ï¼ˆå¯é¸ï¼‰ -->
          <div class="info-item info-item-location" id="serviceLocationItem" style="display: none;">
            <span class="info-label lang-zh">æœå‹™æ“šé»ï¼š</span>
            <span class="info-label lang-en">Service Location:</span>
            <span class="info-value lang-zh edit-clickable" id="previewServiceLocationZh" onclick="editAddress('serviceLocation', event)">
              <span class="address-text">å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ</span>
              <span class="address-map-link" onclick="openMap('serviceLocation', event)">ğŸ“ åœ°åœ–</span>
            </span>
            <span class="info-value lang-en edit-clickable" id="previewServiceLocationEn" onclick="editAddress('serviceLocation', event)">
              <span class="address-text">No. 7, Section 5, Xinyi Road, Xinyi District, Taipei</span>
              <span class="address-map-link" onclick="openMap('serviceLocation', event)">ğŸ“ Map</span>
            </span>
            <button class="info-delete-btn" onclick="deleteCompanyInfo('serviceLocation')" title="åˆªé™¤">Ã—</button>
          </div>
          
          <!-- é€šè¨Šä½å€ï¼ˆå¯é¸ï¼‰ -->
          <div class="info-item info-item-location" id="mailingAddressItem" style="display: none;">
            <span class="info-label lang-zh">é€šè¨Šä½å€ï¼š</span>
            <span class="info-label lang-en">Mailing Address:</span>
            <span class="info-value lang-zh edit-clickable" id="previewMailingAddressZh" onclick="editAddress('mailingAddress', event)">
              <span class="address-text">å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ</span>
              <span class="address-map-link" onclick="openMap('mailingAddress', event)">ğŸ“ åœ°åœ–</span>
            </span>
            <span class="info-value lang-en edit-clickable" id="previewMailingAddressEn" onclick="editAddress('mailingAddress', event)">
              <span class="address-text">No. 7, Section 5, Xinyi Road, Xinyi District, Taipei</span>
              <span class="address-map-link" onclick="openMap('mailingAddress', event)">ğŸ“ Map</span>
            </span>
            <button class="info-delete-btn" onclick="deleteCompanyInfo('mailingAddress')" title="åˆªé™¤">Ã—</button>
          </div>
          
          <!-- å…¬å¸ä½å€ï¼ˆå¯é¸ï¼‰ -->
          <div class="info-item info-item-location" id="companyAddressItem" style="display: none;">
            <span class="info-label lang-zh">å…¬å¸ä½å€ï¼š</span>
            <span class="info-label lang-en">Company Address:</span>
            <span class="info-value lang-zh edit-clickable" id="previewCompanyAddressZh" onclick="editAddress('companyAddress', event)">
              <span class="address-text">å°åŒ—å¸‚ä¿¡ç¾©å€ä¿¡ç¾©è·¯äº”æ®µ7è™Ÿ</span>
              <span class="address-map-link" onclick="openMap('companyAddress', event)">ğŸ“ åœ°åœ–</span>
            </span>
            <span class="info-value lang-en edit-clickable" id="previewCompanyAddressEn" onclick="editAddress('companyAddress', event)">
              <span class="address-text">No. 7, Section 5, Xinyi Road, Xinyi District, Taipei</span>
              <span class="address-map-link" onclick="openMap('companyAddress', event)">ğŸ“ Map</span>
            </span>
            <button class="info-delete-btn" onclick="deleteCompanyInfo('companyAddress')" title="åˆªé™¤">Ã—</button>
          </div>
          
          <!-- æ–°å¢å…¬å¸è³‡è¨ŠæŒ‰éˆ• -->
          <button class="edit-add-btn lang-zh" onclick="showCompanyInfoTypeModal(event)">+ æ–°å¢å…¬å¸è³‡è¨Š</button>
          <button class="edit-add-btn lang-en" onclick="showCompanyInfoTypeModal(event)">+ Add Company Info</button>
        </div>

        <div class="divider"></div>

        <div class="section-label lang-zh">è¯çµ¡æ–¹å¼ CONTACT</div>
        <div class="section-label lang-en">CONTACT</div>

        <div class="btn-group" id="previewContacts" style="display: flex; flex-direction: column; gap: 12px; width: 100%;">
          <div class="contact-btn-wrapper">
            <a class="btn btn-primary lang-zh edit-clickable" href="tel:0905519002" onclick="editContact(event, 'call', 'tel:0905519002')">
              <img src="phone-icon.svg" alt="Phone" class="btn-icon-phone"> ç«‹å³ä¾†é›»
            </a>
            <a class="btn btn-primary lang-en edit-clickable" href="tel:0905519002" onclick="editContact(event, 'call', 'tel:0905519002')">
              <img src="phone-icon.svg" alt="Phone" class="btn-icon-phone"> Call Now
            </a>
            <button class="contact-delete-btn" onclick="event.stopPropagation(); deleteContactButton(this.closest('.contact-btn-wrapper').querySelector('a'))" title="åˆªé™¤">âœ•</button>
          </div>
          <div class="contact-btn-wrapper">
            <a class="btn btn-secondary lang-zh edit-clickable" href="https://line.me/R/ti/p/2sSjJ_o6OT" target="_blank" onclick="editContact(event, 'line', 'https://line.me/R/ti/p/2sSjJ_o6OT')">
              <img src="line-logo.svg" alt="LINE" class="btn-icon-line"> åŠ å…¥ LINE
            </a>
            <a class="btn btn-secondary lang-en edit-clickable" href="https://line.me/R/ti/p/2sSjJ_o6OT" target="_blank" onclick="editContact(event, 'line', 'https://line.me/R/ti/p/2sSjJ_o6OT')">
              <img src="line-logo.svg" alt="LINE" class="btn-icon-line"> Add LINE
            </a>
            <button class="contact-delete-btn" onclick="event.stopPropagation(); deleteContactButton(this.closest('.contact-btn-wrapper').querySelector('a'))" title="Delete">âœ•</button>
          </div>
          <div class="contact-btn-wrapper">
            <a class="btn btn-secondary lang-zh edit-clickable" href="mailto:ccccwoho@gmail.com" onclick="editContact(event, 'email', 'mailto:ccccwoho@gmail.com')">
              <img src="email-icon.svg" alt="Email" class="btn-icon-email"> å¯„é€ Email
            </a>
            <a class="btn btn-secondary lang-en edit-clickable" href="mailto:ccccwoho@gmail.com" onclick="editContact(event, 'email', 'mailto:ccccwoho@gmail.com')">
              <img src="email-icon.svg" alt="Email" class="btn-icon-email"> Send Email
            </a>
            <button class="contact-delete-btn" onclick="event.stopPropagation(); deleteContactButton(this.closest('.contact-btn-wrapper').querySelector('a'))" title="åˆªé™¤">âœ•</button>
          </div>
          <div class="contact-btn-wrapper">
            <a class="btn btn-secondary lang-zh edit-clickable" href="yuyu-ko.vcf" download="YuyuKo.vcf" onclick="editContact(event, 'vcf', 'yuyu-ko.vcf')">
              <img src="file-icon.svg" alt="VCF" class="btn-icon-file"> å„²å­˜åˆ°é€šè¨ŠéŒ„ï¼ˆVCFï¼‰
            </a>
            <a class="btn btn-secondary lang-en edit-clickable" href="yuyu-ko.vcf" download="YuyuKo.vcf" onclick="editContact(event, 'vcf', 'yuyu-ko.vcf')">
              <img src="file-icon.svg" alt="VCF" class="btn-icon-file"> Save Contact (VCF)
            </a>
            <button class="contact-delete-btn" onclick="event.stopPropagation(); deleteContactButton(this.closest('.contact-btn-wrapper').querySelector('a'))" title="Delete">âœ•</button>
          </div>
          </div>
          <button class="edit-add-btn lang-zh" onclick="addContact(event)">+ æ–°å¢è¯çµ¡æ–¹å¼</button>
          <button class="edit-add-btn lang-en" onclick="addContact(event)">+ Add Contact Method</button>
        </div>

        <div class="hint lang-zh">
          è‹¥æ‚¨é€é <strong>NFC åç‰‡</strong> æˆ–åˆ†äº«é€£çµé–‹å•Ÿæ­¤é ï¼Œæˆ‘æœƒç›¡å¿«å›è¦†æ‚¨ã€‚
        </div>
        <div class="hint lang-en">
          If you opened this page via <strong>NFC card</strong> or shared link, I will respond as soon as possible.
        </div>
      </div>
    </div>
  </div>
</div>

<!-- è¯çµ¡æ–¹å¼é¡å‹é¸æ“‡å½ˆå‡ºè¦–çª— -->
<div class="contact-type-overlay" id="contactTypeOverlay" onclick="closeContactTypeModal(event)">
  <div class="contact-type-modal" onclick="event.stopPropagation()">
    <h2 class="contact-type-title lang-zh">é¸æ“‡è¯çµ¡æ–¹å¼é¡å‹</h2>
    <h2 class="contact-type-title lang-en">Select Contact Method Type</h2>
    
    <div class="contact-type-grid">
      <button class="contact-type-btn" onclick="selectContactType('company-phone', 'å…¬å¸é›»è©±', 'Company Phone')">
        <span class="contact-type-icon"><img src="phone-icon.svg" alt="Phone" class="contact-type-icon-img"></span>
        <span class="contact-type-label lang-zh">å…¬å¸é›»è©±</span>
        <span class="contact-type-label lang-en">Company Phone</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('personal-phone', 'å€‹äººé›»è©±', 'Personal Phone')">
        <span class="contact-type-icon"><img src="mobile-icon.svg" alt="Mobile" class="contact-type-icon-img"></span>
        <span class="contact-type-label lang-zh">å€‹äººé›»è©±</span>
        <span class="contact-type-label lang-en">Personal Phone</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('email', 'Email', 'Email')">
        <span class="contact-type-icon"><img src="email-icon.svg" alt="Email" class="contact-type-icon-img"></span>
        <span class="contact-type-label">Email</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('website', 'ç¶²ç«™', 'Website')">
        <span class="contact-type-icon"><img src="website-icon.svg" alt="Website" class="contact-type-icon-img"></span>
        <span class="contact-type-label lang-zh">ç¶²ç«™</span>
        <span class="contact-type-label lang-en">Website</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('line', 'LINE', 'LINE')">
        <span class="contact-type-icon"><img src="line-logo.svg" alt="LINE" class="contact-type-icon-img"></span>
        <span class="contact-type-label">LINE</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('official-line', 'å®˜æ–¹LINE', 'Official LINE')">
        <span class="contact-type-icon"><img src="line-logo.svg" alt="LINE" class="contact-type-icon-img"></span>
        <span class="contact-type-label lang-zh">å®˜æ–¹LINE</span>
        <span class="contact-type-label lang-en">Official LINE</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('facebook', 'Facebook', 'Facebook')">
        <span class="contact-type-icon"><img src="facebook-logo.svg" alt="Facebook" class="contact-type-icon-img"></span>
        <span class="contact-type-label">Facebook</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('instagram', 'Instagram', 'Instagram')">
        <span class="contact-type-icon"><img src="instagram-logo.svg" alt="Instagram" class="contact-type-icon-img"></span>
        <span class="contact-type-label">Instagram</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('linkedin', 'LinkedIn', 'LinkedIn')">
        <span class="contact-type-icon"><img src="linkedin-logo.svg" alt="LinkedIn" class="contact-type-icon-img"></span>
        <span class="contact-type-label">LinkedIn</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('twitter', 'X (Twitter)', 'X (Twitter)')">
        <span class="contact-type-icon"><img src="twitter-logo.svg" alt="X" class="contact-type-icon-img"></span>
        <span class="contact-type-label lang-zh">X (Twitter)</span>
        <span class="contact-type-label lang-en">X (Twitter)</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('youtube', 'YouTube', 'YouTube')">
        <span class="contact-type-icon"><img src="youtube-logo.svg" alt="YouTube" class="contact-type-icon-img"></span>
        <span class="contact-type-label">YouTube</span>
      </button>
      
      <button class="contact-type-btn" onclick="selectContactType('wechat', 'å¾®ä¿¡', 'WeChat')">
        <span class="contact-type-icon"><img src="wechat-logo.svg" alt="WeChat" class="contact-type-icon-img"></span>
        <span class="contact-type-label lang-zh">å¾®ä¿¡</span>
        <span class="contact-type-label lang-en">WeChat</span>
      </button>
      
      <button class="contact-type-btn contact-type-btn-whatsapp" onclick="selectContactType('whatsapp', 'WhatsApp', 'WhatsApp')">
        <span class="contact-type-icon"><img src="whatsapp-logo.svg" alt="WhatsApp" class="contact-type-icon-img"></span>
        <span class="contact-type-label">WhatsApp</span>
      </button>
      
      <button class="contact-type-other" onclick="selectContactType('other', 'å…¶ä»–', 'Other')">
        <span class="contact-type-other-icon">+</span>
        <span class="contact-type-other-label lang-zh">å…¶ä»– (è‡ªè¨‚é¡å‹)</span>
        <span class="contact-type-other-label lang-en">Other (Custom Type)</span>
      </button>
    </div>
    
    <div class="contact-type-actions">
      <button class="contact-type-cancel lang-zh" onclick="closeContactTypeModal(event)">å–æ¶ˆ</button>
      <button class="contact-type-cancel lang-en" onclick="closeContactTypeModal(event)">Cancel</button>
    </div>
  </div>
</div>

<!-- é€£çµè¼¸å…¥æ¨¡æ…‹æ¡† -->
<div class="link-input-overlay" id="linkInputOverlay" onclick="closeLinkInputModal(event)">
  <div class="link-input-modal" onclick="event.stopPropagation()">
    <h2 class="link-input-title lang-zh">è¼¸å…¥é€£çµ</h2>
    <h2 class="link-input-title lang-en">Enter Link</h2>
    <input type="text" class="link-input-field" id="linkInputField" placeholder="" autofocus onkeydown="if(event.key === 'Enter') { event.preventDefault(); event.stopPropagation(); submitLinkInput(event); return false; }">
    <div class="link-input-actions">
      <button class="link-input-btn link-input-cancel lang-zh" onclick="closeLinkInputModal(event)">å–æ¶ˆ</button>
      <button class="link-input-btn link-input-cancel lang-en" onclick="closeLinkInputModal(event)">Cancel</button>
      <button class="link-input-btn link-input-submit lang-zh" onclick="submitLinkInput(event)">ç¢ºå®š</button>
      <button class="link-input-btn link-input-submit lang-en" onclick="submitLinkInput(event)">Confirm</button>
    </div>
  </div>
</div>

<!-- è‡ªè¨‚ã€Œå…¶ä»–ã€é¡å‹æ¨¡æ…‹æ¡† -->
<div class="custom-type-overlay" id="customTypeOverlay" onclick="closeCustomTypeModal(event)">
  <div class="custom-type-modal" onclick="event.stopPropagation()">
    <h2 class="custom-type-title lang-zh">è‡ªè¨‚é¡å‹</h2>
    <h2 class="custom-type-title lang-en">Custom Type</h2>

    <div class="custom-type-label lang-zh">ä¸­æ–‡åç¨±</div>
    <div class="custom-type-label lang-en">Chinese Name</div>
    <input class="custom-type-field" id="customTypeZh" type="text" placeholder="ä¾‹å¦‚ï¼šTelegramã€Google Meetã€åç‰‡é€£çµâ€¦">

    <div class="custom-type-label lang-zh">è‹±æ–‡åç¨±</div>
    <div class="custom-type-label lang-en">English Name</div>
    <input class="custom-type-field" id="customTypeEn" type="text" placeholder="e.g. Telegram, Google Meet, Card Link...">

    <div class="custom-type-actions">
      <button class="custom-type-btn custom-type-cancel lang-zh" onclick="closeCustomTypeModal(event)">å–æ¶ˆ</button>
      <button class="custom-type-btn custom-type-cancel lang-en" onclick="closeCustomTypeModal(event)">Cancel</button>
      <button class="custom-type-btn custom-type-confirm lang-zh" onclick="submitCustomType(event)">ç¢ºå®š</button>
      <button class="custom-type-btn custom-type-confirm lang-en" onclick="submitCustomType(event)">Confirm</button>
    </div>
  </div>
</div>

<!-- å…¬å¸è³‡è¨Šé¡å‹é¸æ“‡å½ˆå‡ºè¦–çª— -->
<div class="company-info-type-overlay" id="companyInfoTypeOverlay" onclick="closeCompanyInfoTypeModal(event)">
  <div class="company-info-type-modal" onclick="event.stopPropagation()">
    <h2 class="company-info-type-title lang-zh">é¸æ“‡å…¬å¸è³‡è¨Šé¡å‹</h2>
    <h2 class="company-info-type-title lang-en">Select Company Info Type</h2>
    
    <div class="company-info-type-grid">
      <button class="company-info-type-btn" onclick="selectCompanyInfoType('taxId')">
        <span class="company-info-type-icon">ğŸ”¢</span>
        <span class="company-info-type-label lang-zh">çµ±ä¸€ç·¨è™Ÿ</span>
        <span class="company-info-type-label lang-en">Tax ID</span>
      </button>
      
      <button class="company-info-type-btn" onclick="selectCompanyInfoType('serviceLocation')">
        <span class="company-info-type-icon">ğŸ“</span>
        <span class="company-info-type-label lang-zh">æœå‹™æ“šé»</span>
        <span class="company-info-type-label lang-en">Service Location</span>
      </button>
      
      <button class="company-info-type-btn" onclick="selectCompanyInfoType('mailingAddress')">
        <span class="company-info-type-icon">ğŸ“®</span>
        <span class="company-info-type-label lang-zh">é€šè¨Šä½å€</span>
        <span class="company-info-type-label lang-en">Mailing Address</span>
      </button>
      
      <button class="company-info-type-btn" onclick="selectCompanyInfoType('companyAddress')">
        <span class="company-info-type-icon">ğŸ¢</span>
        <span class="company-info-type-label lang-zh">å…¬å¸ä½å€</span>
        <span class="company-info-type-label lang-en">Company Address</span>
      </button>
    </div>
    
    <div class="company-info-type-actions">
      <button class="company-info-type-cancel lang-zh" onclick="closeCompanyInfoTypeModal(event)">å–æ¶ˆ</button>
      <button class="company-info-type-cancel lang-en" onclick="closeCompanyInfoTypeModal(event)">Cancel</button>
    </div>
  </div>
</div>

<!-- åœ°å€ç·¨è¼¯å½ˆå‡ºè¦–çª— -->
<div class="address-edit-overlay" id="addressEditOverlay" onclick="closeAddressEditModal(event)">
  <div class="address-edit-modal" onclick="event.stopPropagation()">
    <h2 class="address-edit-title lang-zh" id="addressEditTitleZh">ç·¨è¼¯åœ°å€</h2>
    <h2 class="address-edit-title lang-en" id="addressEditTitleEn">Edit Address</h2>
    
    <div class="address-edit-form">
      <div class="address-edit-group">
        <label class="address-edit-label lang-zh">ä¸­æ–‡åœ°å€</label>
        <label class="address-edit-label lang-en">Chinese Address</label>
        <textarea class="address-edit-textarea" id="addressEditZh" rows="3" placeholder="è«‹è¼¸å…¥ä¸­æ–‡åœ°å€"></textarea>
      </div>
      
      <div class="address-edit-group">
        <label class="address-edit-label lang-zh">è‹±æ–‡åœ°å€</label>
        <label class="address-edit-label lang-en">English Address</label>
        <textarea class="address-edit-textarea" id="addressEditEn" rows="3" placeholder="Enter English address"></textarea>
      </div>
      
      <div class="address-edit-map-section">
        <button class="address-edit-map-btn lang-zh" onclick="generateMapLink()">
          <span class="map-icon">ğŸ“</span>
          <span>é–‹å•Ÿåœ°åœ–</span>
        </button>
        <button class="address-edit-map-btn lang-en" onclick="generateMapLink()">
          <span class="map-icon">ğŸ“</span>
          <span>Open Map</span>
        </button>
        <a class="address-edit-map-link" id="addressMapLink" href="#" target="_blank" style="display: none;">
          <span class="lang-zh">åœ¨ Google Maps ä¸­æŸ¥çœ‹</span>
          <span class="lang-en">View on Google Maps</span>
        </a>
      </div>
    </div>
    
    <div class="address-edit-actions">
      <button class="address-edit-btn address-edit-cancel lang-zh" onclick="closeAddressEditModal(event)">å–æ¶ˆ</button>
      <button class="address-edit-btn address-edit-cancel lang-en" onclick="closeAddressEditModal(event)">Cancel</button>
      <button class="address-edit-btn address-edit-submit lang-zh" onclick="submitAddressEdit(event)">ç¢ºå®š</button>
      <button class="address-edit-btn address-edit-submit lang-en" onclick="submitAddressEdit(event)">Confirm</button>
    </div>
  </div>
</div>

<!-- ä¸»é¡Œé¸æ“‡å™¨æ¨¡æ…‹æ¡† -->
<div class="theme-selector-overlay" id="themeSelectorOverlay" onclick="closeThemeSelector(event)">
  <div class="theme-selector-modal" onclick="event.stopPropagation()">
    <div class="theme-selector-header">
      <h2 class="theme-selector-title lang-zh">é¸æ“‡åç‰‡ä¸»é¡Œ</h2>
      <h2 class="theme-selector-title lang-en">Select Card Theme</h2>
      <button class="theme-selector-close" onclick="closeThemeSelector(event)" title="é—œé–‰">Ã—</button>
    </div>
    
    <div class="theme-selector-grid">
      <!-- Theme 1: Dark -->
      <div class="theme-card-preview" data-theme="1" onclick="selectCardTheme(1)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">æ·±è‰²ä¸»é¡Œ</div>
        <div class="theme-card-name lang-en">Dark Theme</div>
      </div>
      
      <!-- Theme 2: Light -->
      <div class="theme-card-preview" data-theme="2" onclick="selectCardTheme(2)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">æ·ºè‰²ä¸»é¡Œ</div>
        <div class="theme-card-name lang-en">Light Theme</div>
      </div>
      
      <!-- Theme 3: Blue -->
      <div class="theme-card-preview" data-theme="3" onclick="selectCardTheme(3)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">è—è‰²ä¸»é¡Œ</div>
        <div class="theme-card-name lang-en">Blue Theme</div>
      </div>
      
      <!-- Theme 4: Gold -->
      <div class="theme-card-preview" data-theme="4" onclick="selectCardTheme(4)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">é‡‘è‰²ä¸»é¡Œ</div>
        <div class="theme-card-name lang-en">Gold Theme</div>
      </div>
      
      <!-- Theme 5: Purple -->
      <div class="theme-card-preview" data-theme="5" onclick="selectCardTheme(5)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">ç´«è‰²ä¸»é¡Œ</div>
        <div class="theme-card-name lang-en">Purple Theme</div>
      </div>

      <!-- Theme 6: Deep Black + Classic Blue -->
      <div class="theme-card-preview" data-theme="6" onclick="selectCardTheme(6)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">æ·±é»‘è—ï¼ˆç¶“å…¸è—ï¼‰</div>
        <div class="theme-card-name lang-en">Deep Black + Classic Blue</div>
      </div>

      <!-- Theme 7: White + Classic Blue -->
      <div class="theme-card-preview" data-theme="7" onclick="selectCardTheme(7)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">ç™½åº•è—ï¼ˆç¶“å…¸è—ï¼‰</div>
        <div class="theme-card-name lang-en">White + Classic Blue</div>
      </div>

      <!-- Theme 8: Deep Black + Teal -->
      <div class="theme-card-preview" data-theme="8" onclick="selectCardTheme(8)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">æ·±é»‘é’ç¶ ï¼ˆé’ç¶ ï¼‰</div>
        <div class="theme-card-name lang-en">Deep Black + Teal</div>
      </div>

      <!-- Theme 9: White + Teal -->
      <div class="theme-card-preview" data-theme="9" onclick="selectCardTheme(9)">
        <div class="theme-preview-wrapper">
          <div class="theme-preview-top-bar"></div>
          <div class="theme-preview-card">
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-text short"></div>
            <div class="theme-preview-text long"></div>
            <div class="theme-preview-button"></div>
          </div>
        </div>
        <div class="theme-card-name lang-zh">ç™½åº•é’ç¶ ï¼ˆé’ç¶ ï¼‰</div>
        <div class="theme-card-name lang-en">White + Teal</div>
      </div>
    </div>
  </div>
</div>

<!-- åº•éƒ¨å°èˆªæ¬„ -->
<nav class="bottom-nav">
  <a href="directory.html" class="nav-item">
    <span class="nav-icon">ğŸ“‹</span>
    <span class="nav-label lang-zh">é€šè¨ŠéŒ„</span>
    <span class="nav-label lang-en">Directory</span>
  </a>
  <a href="settings.html" class="nav-item">
    <span class="nav-icon">âš™ï¸</span>
    <span class="nav-label lang-zh">è¨­å®š</span>
    <span class="nav-label lang-en">Settings</span>
  </a>
</nav>

<script src="common.js"></script>
<script>
// é›²ç«¯ç‰ˆï¼šéœ€è¦ç™»å…¥æ‰å¯ç·¨è¼¯ï¼ˆæœªè¨­å®š Supabase å‰‡ç•¥éï¼‰
(async function () {
  try {
    if (window.UVACO_CLOUD && UVACO_CLOUD.hasConfig()) {
      const here = 'edit.html' + (window.location.search || '');
      const r = await UVACO_CLOUD.requireAuth(here);
      if (!r.ok) return;
    }
  } catch (e) {}
})();

// èšç„¦ç·¨è¼¯
function focusEdit(element) {
  element.focus();
  // é¸ä¸­æ‰€æœ‰æ–‡å­—
  const range = document.createRange();
  range.selectNodeContents(element);
  const selection = window.getSelection();
  selection.removeAllRanges();
  selection.addRange(range);
}

// å¾é è¦½æ›´æ–°å§“å
function updateNameFromPreview() {
  const nameZhEl = document.getElementById('previewNameZh');
  const nameEnEl = document.getElementById('previewNameEn');
  const nameZhText = nameZhEl.textContent.trim();
  const nameEnText = nameEnEl.textContent.trim();
  
  // è§£æå§“åï¼ˆæ ¼å¼ï¼šä¸­æ–‡å ï½œ è‹±æ–‡åï¼‰
  const zhMatch = nameZhText.match(/^(.+?)\s*ï½œ\s*(.+)$/);
  const enMatch = nameEnText.match(/^(.+?)\s*ï½œ\s*(.+)$/);
  
  if (zhMatch) {
    nameZhEl.innerHTML = zhMatch[1] + ' ï½œ <span class="en">' + zhMatch[2] + '</span>';
  }
  if (enMatch) {
    nameEnEl.innerHTML = enMatch[1] + ' ï½œ <span class="en">' + enMatch[1].split(' ')[0] + '</span>';
  }
}

// å¾é è¦½æ›´æ–°è·å‹™
function updateTitleFromPreview() {
  const titleZhEl = document.getElementById('previewTitleZh');
  const titleEnEl = document.getElementById('previewTitleEn');
  // è·å‹™å·²ç¶“ç›´æ¥ç·¨è¼¯ï¼Œä¸éœ€è¦é¡å¤–è™•ç†
}

// æ›´æ–°æ¨™èªé è¦½
function updateSlogansPreview() {
  const zhSlogans = Array.from(document.querySelectorAll('#slogansZhList .edit-slogan-input')).map(input => input.value);
  const enSlogans = Array.from(document.querySelectorAll('#slogansEnList .edit-slogan-input')).map(input => input.value);
  
  const zhContainer = document.getElementById('previewSlogansZh');
  const enContainer = document.getElementById('previewSlogansEn');
  
  zhContainer.innerHTML = zhSlogans.map(slogan => `<div class="tagline lang-zh">${slogan}</div>`).join('');
  enContainer.innerHTML = enSlogans.map(slogan => `<div class="tagline lang-en">${slogan}</div>`).join('');
}

// ç·¨è¼¯ LOGO
function editLogo() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = 'image/*';
  input.onchange = function(event) {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('previewLogo').src = e.target.result;
      };
      reader.readAsDataURL(file);
    }
  };
  input.click();
}

// ç·¨è¼¯é ­åƒ
function editAvatar() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = 'image/*';
  input.onchange = function(event) {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('previewAvatar').src = e.target.result;
      };
      reader.readAsDataURL(file);
    }
  };
  input.click();
}

// ç·¨è¼¯è¯çµ¡æ–¹å¼
function editContact(event, type, currentLink) {
  event.preventDefault();
  event.stopPropagation();
  
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  
  // è¨­ç½®ç·¨è¼¯æ¨¡å¼
  window.isEditingContact = true;
  window.editingContactInfo = {
    type: type,
    currentLink: currentLink
  };
  
  // é¡¯ç¤ºé€£çµè¼¸å…¥æ¨¡æ…‹æ¡†ï¼Œé å¡«ç•¶å‰é€£çµ
  showLinkInputModal(currentLink, currentLang);
}

// åˆªé™¤è¯çµ¡æ–¹å¼æŒ‰éˆ•
function deleteContactButton(btn) {
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  const confirmMsg = currentLang === 'zh' ? 'ç¢ºå®šè¦åˆªé™¤æ­¤è¯çµ¡æ–¹å¼å—ï¼Ÿ' : 'Are you sure you want to delete this contact method?';
  
  if (confirm(confirmMsg)) {
    // æ‰¾åˆ°å°æ‡‰çš„ä¸­æ–‡æˆ–è‹±æ–‡æŒ‰éˆ•ä¸¦åˆªé™¤
    const currentLink = btn.href;
    const allButtons = document.querySelectorAll(`#previewContacts a[href="${currentLink}"]`);
    allButtons.forEach(b => b.remove());
  }
}

// æ–°å¢æ¨™èªåˆ°é è¦½
function addSloganToPreview(lang) {
  const containerId = lang === 'zh' ? 'previewSlogansZh' : 'previewSlogansEn';
  const container = document.getElementById(containerId);
  const sloganItem = document.createElement('div');
  sloganItem.className = 'slogan-item';
  
  const tagline = document.createElement('div');
  tagline.className = `tagline lang-${lang} edit-clickable`;
  tagline.contentEditable = 'true';
  tagline.textContent = lang === 'zh' ? 'æ–°æ¨™èª' : 'New Slogan';
  tagline.onblur = function() { updateSlogansPreview(); };
  tagline.onclick = function() { focusEdit(this); };
  
  const deleteBtn = document.createElement('button');
  deleteBtn.className = 'slogan-delete-btn';
  deleteBtn.textContent = 'âœ•';
  deleteBtn.title = lang === 'zh' ? 'åˆªé™¤æ¨™èª' : 'Delete slogan';
  deleteBtn.onclick = function(event) {
    event.stopPropagation();
    deleteSloganFromPreview(this);
  };
  
  sloganItem.appendChild(tagline);
  sloganItem.appendChild(deleteBtn);
  container.appendChild(sloganItem);
  
  tagline.focus();
  focusEdit(tagline);
}

// å¾é è¦½åˆªé™¤æ¨™èª
function deleteSloganFromPreview(btn) {
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  const confirmMsg = currentLang === 'zh' ? 'ç¢ºå®šè¦åˆªé™¤æ­¤æ¨™èªå—ï¼Ÿ' : 'Are you sure you want to delete this slogan?';
  
  if (confirm(confirmMsg)) {
    btn.closest('.slogan-item').remove();
  }
}

// é¡¯ç¤ºè¯çµ¡æ–¹å¼é¡å‹é¸æ“‡å½ˆå‡ºè¦–çª—
function addContact(event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  const overlay = document.getElementById('contactTypeOverlay');
  if (overlay) {
    overlay.classList.add('show');
    overlay.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    console.log('Contact type overlay shown');
  } else {
    console.error('contactTypeOverlay element not found');
  }
}

// é—œé–‰è¯çµ¡æ–¹å¼é¡å‹é¸æ“‡å½ˆå‡ºè¦–çª—
function closeContactTypeModal(event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  
  const overlay = document.getElementById('contactTypeOverlay');
  if (!overlay) return;
  
  // å¦‚æœé»æ“Šçš„æ˜¯å–æ¶ˆæŒ‰éˆ•ï¼Œç›´æ¥é—œé–‰
  if (event && event.target && event.target.classList.contains('contact-type-cancel')) {
    overlay.classList.remove('show');
    overlay.style.display = 'none';
    document.body.style.overflow = '';
    return;
  }
  
  // å¦‚æœé»æ“Šçš„æ˜¯ overlay èƒŒæ™¯ï¼ˆä¸æ˜¯ modal å…§éƒ¨ï¼‰ï¼Œå‰‡é—œé–‰
  if (event && event.target && event.target.id === 'contactTypeOverlay') {
    overlay.classList.remove('show');
    overlay.style.display = 'none';
    document.body.style.overflow = '';
  }
}

// ç²å–è¯çµ¡æ–¹å¼åœ–ç¤º
function getContactIcon(type) {
  const icons = {
    'company-phone': '<img src="phone-icon.svg" alt="Phone" class="btn-icon-phone">',
    'personal-phone': '<img src="mobile-icon.svg" alt="Mobile" class="btn-icon-mobile">',
    'email': '<img src="email-icon.svg" alt="Email" class="btn-icon-email">',
    'website': '<img src="website-icon.svg" alt="Website" class="btn-icon-website">',
    'line': '<img src="line-logo.svg" alt="LINE" class="btn-icon-line">',
    'official-line': '<img src="line-logo.svg" alt="LINE" class="btn-icon-line">',
    'facebook': '<img src="facebook-logo.svg" alt="Facebook" class="btn-icon-facebook">',
    'instagram': '<img src="instagram-logo.svg" alt="Instagram" class="btn-icon-instagram">',
    'linkedin': '<img src="linkedin-logo.svg" alt="LinkedIn" class="btn-icon-linkedin">',
    'twitter': '<img src="twitter-logo.svg" alt="X" class="btn-icon-twitter">',
    'youtube': '<img src="youtube-logo.svg" alt="YouTube" class="btn-icon-youtube">',
    'wechat': '<img src="wechat-logo.svg" alt="WeChat" class="btn-icon-wechat">',
    'whatsapp': '<img src="whatsapp-logo.svg" alt="WhatsApp" class="btn-icon-whatsapp">',
    'call': '<img src="phone-icon.svg" alt="Phone" class="btn-icon-phone">',
    'vcf': '<img src="file-icon.svg" alt="VCF" class="btn-icon-file">',
    'other': 'â•'
  };
  return icons[type] || 'ğŸ“‹';
}

// é¸æ“‡è¯çµ¡æ–¹å¼é¡å‹
function selectContactType(type, labelZh, labelEn) {
  // é—œé–‰é¡å‹é¸æ“‡å½ˆå‡ºè¦–çª—
  const typeOverlay = document.getElementById('contactTypeOverlay');
  if (typeOverlay) {
    typeOverlay.classList.remove('show');
    typeOverlay.style.display = 'none';
  }
  
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  
  // å…¶ä»–ï¼šå…è¨±è‡ªè¨‚ã€Œç¨®é¡åç¨±ã€
  if (type === 'other') {
    window.pendingCustomType = {
      type: 'other',
      labelZh: labelZh || 'å…¶ä»–',
      labelEn: labelEn || 'Other'
    };
    showCustomTypeModal();
    return;
  }

  // æ ¹æ“šé¡å‹è¨­å®šé è¨­é€£çµæ ¼å¼å’Œæ¨™ç±¤
  let defaultLink = '';
  let buttonTextZh = '';
  let buttonTextEn = '';
  
  switch(type) {
    case 'company-phone':
      defaultLink = 'tel:';
      buttonTextZh = '<img src="phone-icon.svg" alt="Phone" class="btn-icon-phone"> å…¬å¸é›»è©±';
      buttonTextEn = '<img src="phone-icon.svg" alt="Phone" class="btn-icon-phone"> Company Phone';
      break;
    case 'personal-phone':
      defaultLink = 'tel:';
      buttonTextZh = '<img src="mobile-icon.svg" alt="Mobile" class="btn-icon-mobile"> å€‹äººé›»è©±';
      buttonTextEn = '<img src="mobile-icon.svg" alt="Mobile" class="btn-icon-mobile"> Personal Phone';
      break;
    case 'call':
      defaultLink = 'tel:0905519002';
      buttonTextZh = '<img src="phone-icon.svg" alt="Phone" class="btn-icon-phone"> ç«‹å³ä¾†é›»';
      buttonTextEn = '<img src="phone-icon.svg" alt="Phone" class="btn-icon-phone"> Call Now';
      break;
    case 'email':
      defaultLink = 'mailto:';
      buttonTextZh = '<img src="email-icon.svg" alt="Email" class="btn-icon-email"> å¯„é€ Email';
      buttonTextEn = '<img src="email-icon.svg" alt="Email" class="btn-icon-email"> Send Email';
      break;
    case 'website':
      defaultLink = 'https://';
      buttonTextZh = '<img src="website-icon.svg" alt="Website" class="btn-icon-website"> ç¶²ç«™';
      buttonTextEn = '<img src="website-icon.svg" alt="Website" class="btn-icon-website"> Website';
      break;
    case 'line':
    case 'official-line':
      defaultLink = 'https://line.me/R/ti/p/';
      buttonTextZh = '<img src="line-logo.svg" alt="LINE" class="btn-icon-line"> åŠ å…¥ LINE';
      buttonTextEn = '<img src="line-logo.svg" alt="LINE" class="btn-icon-line"> Add LINE';
      break;
    case 'facebook':
      defaultLink = 'https://www.facebook.com/';
      buttonTextZh = '<img src="facebook-logo.svg" alt="Facebook" class="btn-icon-facebook"> Facebook';
      buttonTextEn = '<img src="facebook-logo.svg" alt="Facebook" class="btn-icon-facebook"> Facebook';
      break;
    case 'instagram':
      defaultLink = 'https://www.instagram.com/';
      buttonTextZh = '<img src="instagram-logo.svg" alt="Instagram" class="btn-icon-instagram"> Instagram';
      buttonTextEn = '<img src="instagram-logo.svg" alt="Instagram" class="btn-icon-instagram"> Instagram';
      break;
    case 'linkedin':
      defaultLink = 'https://www.linkedin.com/in/';
      buttonTextZh = '<img src="linkedin-logo.svg" alt="LinkedIn" class="btn-icon-linkedin"> LinkedIn';
      buttonTextEn = '<img src="linkedin-logo.svg" alt="LinkedIn" class="btn-icon-linkedin"> LinkedIn';
      break;
    case 'twitter':
      defaultLink = 'https://twitter.com/';
      buttonTextZh = '<img src="twitter-logo.svg" alt="X" class="btn-icon-twitter"> X (Twitter)';
      buttonTextEn = '<img src="twitter-logo.svg" alt="X" class="btn-icon-twitter"> X (Twitter)';
      break;
    case 'youtube':
      defaultLink = 'https://www.youtube.com/';
      buttonTextZh = '<img src="youtube-logo.svg" alt="YouTube" class="btn-icon-youtube"> YouTube';
      buttonTextEn = '<img src="youtube-logo.svg" alt="YouTube" class="btn-icon-youtube"> YouTube';
      break;
    case 'wechat':
      defaultLink = 'weixin://';
      buttonTextZh = '<img src="wechat-logo.svg" alt="WeChat" class="btn-icon-wechat"> å¾®ä¿¡';
      buttonTextEn = '<img src="wechat-logo.svg" alt="WeChat" class="btn-icon-wechat"> WeChat';
      break;
    case 'whatsapp':
      defaultLink = 'https://wa.me/';
      buttonTextZh = '<img src="whatsapp-logo.svg" alt="WhatsApp" class="btn-icon-whatsapp"> WhatsApp';
      buttonTextEn = '<img src="whatsapp-logo.svg" alt="WhatsApp" class="btn-icon-whatsapp"> WhatsApp';
      break;
    case 'vcf':
      defaultLink = 'yuyu-ko.vcf';
      buttonTextZh = '<img src="file-icon.svg" alt="VCF" class="btn-icon-file"> å„²å­˜åˆ°é€šè¨ŠéŒ„ï¼ˆVCFï¼‰';
      buttonTextEn = '<img src="file-icon.svg" alt="VCF" class="btn-icon-file"> Save Contact (VCF)';
      break;
    default:
      defaultLink = '';
      buttonTextZh = 'ğŸ”— ' + labelZh;
      buttonTextEn = 'ğŸ”— ' + labelEn;
  }
  
  // ä¿å­˜ç•¶å‰é¸æ“‡çš„é¡å‹ä¿¡æ¯ï¼Œç”¨æ–¼å¾ŒçºŒè™•ç†
  window.currentContactType = {
    type: type,
    labelZh: labelZh,
    labelEn: labelEn,
    defaultLink: defaultLink,
    buttonTextZh: buttonTextZh,
    buttonTextEn: buttonTextEn
  };
  
  // ç«‹å³é¡¯ç¤ºé€£çµè¼¸å…¥æ¨¡æ…‹æ¡†ï¼ˆä¸é—œé–‰ body overflowï¼Œå› ç‚ºæ¨¡æ…‹æ¡†æœƒä¿æŒï¼‰
  setTimeout(() => {
    showLinkInputModal(defaultLink, currentLang);
  }, 100);
}

// ===== è‡ªè¨‚ã€Œå…¶ä»–ã€é¡å‹ =====
function showCustomTypeModal() {
  const overlay = document.getElementById('customTypeOverlay');
  if (!overlay) return;

  // æ¸…ç©º / é å¡«
  const zh = document.getElementById('customTypeZh');
  const en = document.getElementById('customTypeEn');
  if (zh) zh.value = '';
  if (en) en.value = '';

  overlay.classList.add('show');
  document.body.style.overflow = 'hidden';
  setTimeout(() => {
    if (zh) zh.focus();
  }, 50);
}

function closeCustomTypeModal(event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  const overlay = document.getElementById('customTypeOverlay');
  if (overlay) {
    overlay.classList.remove('show');
  }
  document.body.style.overflow = '';
  window.pendingCustomType = null;
}

function submitCustomType(event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  const zhEl = document.getElementById('customTypeZh');
  const enEl = document.getElementById('customTypeEn');
  const zhName = (zhEl?.value || '').trim();
  const enName = (enEl?.value || '').trim();

  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';

  if (!zhName && !enName) {
    alert(currentLang === 'zh' ? 'è«‹è‡³å°‘è¼¸å…¥ä¸€å€‹åç¨±' : 'Please enter at least one name');
    return;
  }

  // è‹¥åªå¡«ä¸€ç¨®èªè¨€ï¼Œå¦ä¸€ç¨®è‡ªå‹•ç”¨åŒä¸€å€‹åç¨±
  const finalZh = zhName || enName;
  const finalEn = enName || zhName;

  // ç”¨ä¸»é¡Œ accent çš„ icon + è‡ªè¨‚æ–‡å­—
  const icon = getContactIcon('other');
  const buttonTextZh = `${icon} ${finalZh}`;
  const buttonTextEn = `${icon} ${finalEn}`;

  // è¨­å®šç‚ºæ–°å¢æ¨¡å¼ï¼Œä¸‹ä¸€æ­¥è¼¸å…¥é€£çµ
  window.currentContactType = {
    type: 'other',
    labelZh: finalZh,
    labelEn: finalEn,
    defaultLink: '',
    buttonTextZh,
    buttonTextEn
  };

  closeCustomTypeModal();

  // é€²å…¥é€£çµè¼¸å…¥æµç¨‹
  showLinkInputModal('', currentLang);
}

// é¡¯ç¤ºé€£çµè¼¸å…¥æ¨¡æ…‹æ¡†
function showLinkInputModal(defaultLink, currentLang) {
  const overlay = document.getElementById('linkInputOverlay');
  const inputField = document.getElementById('linkInputField');
  
  if (overlay && inputField) {
    inputField.value = defaultLink || '';
    inputField.placeholder = currentLang === 'zh' ? 'è«‹è¼¸å…¥é€£çµ' : 'Please enter link';
    // é‡ç½®æäº¤æ¨™è¨˜ï¼ˆåŒ…æ‹¬å…¨å±€æ¨™è¨˜ï¼‰
    inputField.dataset.submitted = 'false';
    window.isSubmittingLink = false;
    overlay.classList.add('show');
    overlay.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    // èšç„¦è¼¸å…¥æ¡†
    setTimeout(() => {
      inputField.focus();
      inputField.select();
    }, 100);
  }
}

// é—œé–‰é€£çµè¼¸å…¥æ¨¡æ…‹æ¡†
function closeLinkInputModal(event) {
  if (event && event.target && event.target.closest('.link-input-modal') && !event.target.classList.contains('link-input-cancel')) {
    return;
  }
  
  const overlay = document.getElementById('linkInputOverlay');
  if (overlay) {
    overlay.classList.remove('show');
    overlay.style.display = 'none';
    document.body.style.overflow = '';
  }
  
  // æ¸…é™¤ä¿å­˜çš„é¡å‹ä¿¡æ¯å’Œæäº¤æ¨™è¨˜
  window.currentContactType = null;
  window.isSubmittingLink = false;
  window.isEditingContact = false;
  window.editingContactInfo = null;
  const inputField = document.getElementById('linkInputField');
  if (inputField) {
    inputField.dataset.submitted = 'false';
  }
}

// æäº¤é€£çµè¼¸å…¥
function submitLinkInput(event) {
  // é˜²æ­¢é‡è¤‡æäº¤ - ç«‹å³æª¢æŸ¥å…¨å±€æ¨™è¨˜
  if (window.isSubmittingLink) {
    console.log('Already submitting, ignoring duplicate call');
    return;
  }
  
  // é˜²æ­¢é‡è¤‡æäº¤
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  
  const inputField = document.getElementById('linkInputField');
  
  // æª¢æŸ¥æ˜¯å¦å·²ç¶“æäº¤éï¼ˆé˜²æ­¢é‡è¤‡æäº¤ï¼‰
  if (inputField.dataset.submitted === 'true') {
    console.log('Already submitted, ignoring duplicate call');
    return;
  }
  
  // ç«‹å³è¨­ç½®å…¨å±€æ¨™è¨˜å’Œæœ¬åœ°æ¨™è¨˜ï¼Œé˜²æ­¢é‡è¤‡æäº¤
  window.isSubmittingLink = true;
  inputField.dataset.submitted = 'true';
  
  let newLink = inputField.value.trim();
  
  // å¦‚æœè¼¸å…¥ç‚ºç©ºï¼Œæç¤ºç”¨æˆ¶ä¸¦é‡ç½®æ¨™è¨˜
  if (newLink === '') {
    const zhElements = document.querySelectorAll('.lang-zh');
    const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
    alert(currentLang === 'zh' ? 'é€£çµä¸èƒ½ç‚ºç©º' : 'Link cannot be empty');
    // é‡ç½®æ¨™è¨˜ï¼Œå…è¨±ç”¨æˆ¶é‡æ–°è¼¸å…¥
    window.isSubmittingLink = false;
    inputField.dataset.submitted = 'false';
    return;
  }
  
  // åˆ¤æ–·æ˜¯ç·¨è¼¯æ¨¡å¼é‚„æ˜¯æ–°å¢æ¨¡å¼
  if (window.isEditingContact && window.editingContactInfo) {
    // ç·¨è¼¯æ¨¡å¼ï¼šæ›´æ–°ç¾æœ‰æŒ‰éˆ•
    updateContactButtons(window.editingContactInfo.type, window.editingContactInfo.currentLink, newLink);
  } else if (window.currentContactType) {
    // æ–°å¢æ¨¡å¼ï¼šæ·»åŠ æ–°æŒ‰éˆ•
    const contactType = window.currentContactType;
    addContactButtonToPreview(contactType.type, newLink, contactType.buttonTextZh, contactType.buttonTextEn);
  } else {
    console.error('Contact type or editing info not found');
    window.isSubmittingLink = false;
    inputField.dataset.submitted = 'false';
    return;
  }
  
  // é—œé–‰è¼¸å…¥æ¨¡æ…‹æ¡†
  closeLinkInputModal();
  
  // é‡ç½®å…¨å±€æ¨™è¨˜
  window.isSubmittingLink = false;
}

// æ›´æ–°ç¾æœ‰çš„è¯çµ¡æ–¹å¼æŒ‰éˆ•
function updateContactButtons(type, currentLink, newLink) {
  // æ›´æ–°æ‰€æœ‰ç›¸é—œçš„æŒ‰éˆ•é€£çµï¼ˆä¸­æ–‡å’Œè‹±æ–‡ï¼‰
  const buttons = document.querySelectorAll(`#previewContacts a[href="${currentLink}"]`);
  buttons.forEach(btn => {
    btn.href = newLink;
    // æ›´æ–° onclick äº‹ä»¶ä¸­çš„é€£çµåƒæ•¸
    btn.onclick = function(e) {
      editContact(e, type, newLink);
    };
  });
  console.log('Contact buttons updated');
}

// ===== å…¬å¸è³‡è¨Šç›¸é—œåŠŸèƒ½ =====

// é¡¯ç¤ºå…¬å¸è³‡è¨Šé¡å‹é¸æ“‡å½ˆçª—
function showCompanyInfoTypeModal(event) {
  event.preventDefault();
  event.stopPropagation();
  
  const overlay = document.getElementById('companyInfoTypeOverlay');
  if (overlay) {
    overlay.classList.add('show');
    overlay.style.display = 'flex';
    document.body.style.overflow = 'hidden';
  }
}

// é—œé–‰å…¬å¸è³‡è¨Šé¡å‹é¸æ“‡å½ˆçª—
function closeCompanyInfoTypeModal(event) {
  if (event && event.target && event.target.closest('.company-info-type-modal') && !event.target.classList.contains('company-info-type-cancel')) {
    return;
  }
  
  const overlay = document.getElementById('companyInfoTypeOverlay');
  if (overlay) {
    overlay.classList.remove('show');
    overlay.style.display = 'none';
    document.body.style.overflow = '';
  }
}

// é¸æ“‡å…¬å¸è³‡è¨Šé¡å‹
function selectCompanyInfoType(type) {
  closeCompanyInfoTypeModal();
  
  if (type === 'taxId') {
    // çµ±ä¸€ç·¨è™Ÿï¼šç›´æ¥é¡¯ç¤ºè¼¸å…¥æ¡†
    showTaxIdInput();
  } else {
    // åœ°å€é¡å‹ï¼šé¡¯ç¤ºåœ°å€ç·¨è¼¯å½ˆçª—
    showAddressEditModal(type);
  }
}

// é¡¯ç¤ºçµ±ä¸€ç·¨è™Ÿè¼¸å…¥
function showTaxIdInput() {
  const item = document.getElementById('taxIdItem');
  if (item) {
    item.style.display = 'flex';
    const zhInput = document.getElementById('previewTaxIdZh');
    const enInput = document.getElementById('previewTaxIdEn');
    if (zhInput) {
      setTimeout(() => {
        zhInput.focus();
        const range = document.createRange();
        range.selectNodeContents(zhInput);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
      }, 100);
    }
  }
}

// é¡¯ç¤ºåœ°å€ç·¨è¼¯å½ˆçª—
function showAddressEditModal(addressType) {
  window.currentAddressType = addressType;
  
  // è¨­å®šæ¨™é¡Œ
  const titleMap = {
    'serviceLocation': { zh: 'ç·¨è¼¯æœå‹™æ“šé»', en: 'Edit Service Location' },
    'mailingAddress': { zh: 'ç·¨è¼¯é€šè¨Šä½å€', en: 'Edit Mailing Address' },
    'companyAddress': { zh: 'ç·¨è¼¯å…¬å¸ä½å€', en: 'Edit Company Address' }
  };
  
  const titles = titleMap[addressType];
  document.getElementById('addressEditTitleZh').textContent = titles.zh;
  document.getElementById('addressEditTitleEn').textContent = titles.en;
  
  // è¼‰å…¥ç¾æœ‰åœ°å€ï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰
  const zhEl = document.getElementById(`preview${addressType.charAt(0).toUpperCase() + addressType.slice(1)}Zh`);
  const enEl = document.getElementById(`preview${addressType.charAt(0).toUpperCase() + addressType.slice(1)}En`);
  
  const zhText = zhEl ? (zhEl.querySelector('.address-text')?.textContent || '').trim() : '';
  const enText = enEl ? (enEl.querySelector('.address-text')?.textContent || '').trim() : '';
  
  document.getElementById('addressEditZh').value = zhText;
  document.getElementById('addressEditEn').value = enText;
  
  // éš±è—åœ°åœ–é€£çµ
  const mapLink = document.getElementById('addressMapLink');
  if (mapLink) {
    mapLink.style.display = 'none';
  }
  
  // é¡¯ç¤ºå½ˆçª—
  const overlay = document.getElementById('addressEditOverlay');
  if (overlay) {
    overlay.classList.add('show');
    overlay.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    setTimeout(() => {
      document.getElementById('addressEditZh').focus();
    }, 100);
  }
}

// é—œé–‰åœ°å€ç·¨è¼¯å½ˆçª—
function closeAddressEditModal(event) {
  if (event && event.target && event.target.closest('.address-edit-modal') && !event.target.classList.contains('address-edit-cancel') && !event.target.classList.contains('address-edit-submit')) {
    return;
  }
  
  const overlay = document.getElementById('addressEditOverlay');
  if (overlay) {
    overlay.classList.remove('show');
    overlay.style.display = 'none';
    document.body.style.overflow = '';
  }
  
  window.currentAddressType = null;
}

// æäº¤åœ°å€ç·¨è¼¯
function submitAddressEdit(event) {
  event.preventDefault();
  event.stopPropagation();
  
  const addressType = window.currentAddressType;
  if (!addressType) return;
  
  const zhAddress = document.getElementById('addressEditZh').value.trim();
  const enAddress = document.getElementById('addressEditEn').value.trim();
  
  if (!zhAddress && !enAddress) {
    const zhElements = document.querySelectorAll('.lang-zh');
    const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
    alert(currentLang === 'zh' ? 'è«‹è‡³å°‘è¼¸å…¥ä¸€å€‹åœ°å€' : 'Please enter at least one address');
    return;
  }
  
  // æ›´æ–°é è¦½å€åŸŸ
  updateAddressPreview(addressType, zhAddress, enAddress);
  
  // é¡¯ç¤ºå°æ‡‰çš„é …ç›®
  const itemId = addressType + 'Item';
  const item = document.getElementById(itemId);
  if (item) {
    item.style.display = 'flex';
  }
  
  closeAddressEditModal();
}

// ===== å¡ç‰‡ä¸»é¡Œé¸æ“‡åŠŸèƒ½ =====

// é¡¯ç¤ºä¸»é¡Œé¸æ“‡å™¨æ¨¡æ…‹æ¡†
function showThemeSelector() {
  const overlay = document.getElementById('themeSelectorOverlay');
  if (overlay) {
    overlay.classList.add('show');
    document.body.style.overflow = 'hidden';
    
    // é«˜äº®ç•¶å‰é¸ä¸­çš„ä¸»é¡Œ
    const savedTheme = localStorage.getItem('cardTheme');
    if (savedTheme) {
      updateThemePreviewActive(parseInt(savedTheme));
    }
  }
}

// é—œé–‰ä¸»é¡Œé¸æ“‡å™¨æ¨¡æ…‹æ¡†
function closeThemeSelector(event) {
  if (event && event.target && !event.target.classList.contains('theme-selector-overlay') && !event.target.classList.contains('theme-selector-close')) {
    return;
  }
  
  const overlay = document.getElementById('themeSelectorOverlay');
  if (overlay) {
    overlay.classList.remove('show');
    document.body.style.overflow = '';
  }
}

// æ›´æ–°ä¸»é¡Œé è¦½çš„ active ç‹€æ…‹
function updateThemePreviewActive(themeNumber) {
  const previews = document.querySelectorAll('.theme-card-preview');
  previews.forEach(preview => {
    preview.classList.remove('active');
  });
  const selectedPreview = document.querySelector('.theme-card-preview[data-theme="' + themeNumber + '"]');
  if (selectedPreview) {
    selectedPreview.classList.add('active');
  }
}

// é¸æ“‡å¡ç‰‡ä¸»é¡Œï¼ˆç·¨è¼¯é é¢ - åªæ›´æ–°å¡ç‰‡ï¼Œä¸æ›´æ–° bodyï¼‰
function selectCardTheme(themeNumber) {
  console.log('Selecting card theme:', themeNumber);
  
  // åœ¨ç·¨è¼¯é ï¼šå¡ç‰‡ä¸»é¡Œéœ€è¦ã€Œå®Œæ•´é è¦½ã€æ•´é«”ç‰ˆé¢
  // - ä½¿ç”¨ styles.css å…§å»ºçš„ body.card-theme-*ï¼ˆæ•´é èƒŒæ™¯/é ‚éƒ¨æ¬„/åº•éƒ¨æ¬„ï¼‰
  // - åŒæ™‚ä¿ç•™ theme-dark/theme-lightï¼ˆè®“ edit.html æ—¢æœ‰çš„æ¨¡æ…‹æ¡†/æŒ‰éˆ•æ¨£å¼è¦å‰‡ç”Ÿæ•ˆï¼‰
  // - ç§»é™¤ common.js çš„ body.theme-1~5ï¼ˆé¿å…å…©å¥—ä¸»é¡Œäº’ç›¸è¦†è“‹é€ æˆã€Œåˆ‡ä¸å®Œæ•´ã€ï¼‰
  function applyCardThemeToBody(n) {
    // æ¸…æ‰ common.js å…¨åŸŸä¸»é¡Œé¡åˆ¥ï¼ˆtheme-1~7ï¼‰ï¼Œé¿å…è·Ÿ card-theme-* æ‰“æ¶
    document.body.classList.remove('theme-1', 'theme-2', 'theme-3', 'theme-4', 'theme-5', 'theme-6', 'theme-7', 'theme-8', 'theme-9');

    // æ¸…æ‰èˆŠçš„å¡ç‰‡ä¸»é¡Œï¼ˆæ•´é ï¼‰
    document.body.classList.remove('card-theme-1', 'card-theme-2', 'card-theme-3', 'card-theme-4', 'card-theme-5', 'card-theme-6', 'card-theme-7', 'card-theme-8', 'card-theme-9');

    // å¥—ç”¨æ–°çš„å¡ç‰‡ä¸»é¡Œï¼ˆæ•´é ï¼‰
    if (n >= 1 && n <= 9) {
      document.body.classList.add('card-theme-' + n);
    }

    // å°æ‡‰ light/darkï¼ˆedit.html å…§å¤§é‡ä¾è³´ theme-dark/theme-lightï¼‰
    document.body.classList.remove('theme-dark', 'theme-light');
    if (n === 2 || n === 7 || n === 9) {
      document.body.classList.add('theme-light');
    } else {
      document.body.classList.add('theme-dark');
    }
  }

  // ç›´æ¥æ“ä½œ DOM æ›´æ–°å¡ç‰‡ä¸»é¡Œ
  const card = document.getElementById('previewCard');
  if (card) {
    // ç§»é™¤æ‰€æœ‰èˆŠçš„ä¸»é¡Œé¡åˆ¥
    card.classList.remove('card-theme-1', 'card-theme-2', 'card-theme-3', 'card-theme-4', 'card-theme-5', 'card-theme-6', 'card-theme-7', 'card-theme-8', 'card-theme-9');
    
    // æ·»åŠ æ–°çš„ä¸»é¡Œé¡åˆ¥
    if (themeNumber >= 1 && themeNumber <= 9) {
      card.classList.add('card-theme-' + themeNumber);
      console.log('Applied theme class: card-theme-' + themeNumber);
      console.log('Card classes:', card.className);
    }
  } else {
    console.error('Card element not found!');
  }
  
  // åŒæ­¥æ•´é é è¦½ä¸»é¡Œï¼ˆèƒŒæ™¯/é ‚éƒ¨æ¬„/åº•éƒ¨æ¬„/æ³¡æ³¡/æ¨¡æ…‹æ¡†æ˜æš—ï¼‰
  applyCardThemeToBody(themeNumber);

  // å„²å­˜åˆ° localStorage
  localStorage.setItem('cardTheme', themeNumber);
  // åŒæ­¥å…¨åŸŸä¸»é¡Œï¼ˆyuyuko.html / å…¶ä»–é é¢ç”± common.js è®€å– localStorage.themeï¼‰
  // é€™æ¨£å¾ edit.html è·³å›åç‰‡é æ™‚ï¼Œæ•´é«”ä¸»é¡Œæœƒä¸€è‡´æ›´æ–°
  localStorage.setItem('theme', String(themeNumber));
  
  // æ›´æ–°é è¦½çš„ active ç‹€æ…‹
  updateThemePreviewActive(themeNumber);
  
  // å»¶é²é—œé–‰æ¨¡æ…‹æ¡†ï¼Œè®“ç”¨æˆ¶çœ‹åˆ°é¸ä¸­çš„æ•ˆæœ
  setTimeout(function() {
    closeThemeSelector({ target: document.getElementById('themeSelectorOverlay') });
  }, 500);
}

// åˆå§‹åŒ–å¡ç‰‡ä¸»é¡Œï¼ˆåœ¨ç·¨è¼¯é é¢åªè®€å–ï¼Œä¸è‡ªå‹•æ‡‰ç”¨ï¼‰
function initCardTheme() {
  console.log('Initializing card theme...');
  
  // å¾ localStorage è®€å–
  const savedTheme = localStorage.getItem('cardTheme');
  if (savedTheme) {
    const themeNumber = parseInt(savedTheme);
    console.log('Saved theme:', themeNumber);
    
    if (themeNumber >= 1 && themeNumber <= 9) {
      // åŒæ­¥å…¨åŸŸä¸»é¡Œï¼Œç¢ºä¿è¿”å› yuyuko.html ç­‰é é¢èƒ½ç«‹åˆ»å¥—ç”¨
      localStorage.setItem('theme', String(themeNumber));

      const card = document.getElementById('previewCard');
      if (card) {
        // ç§»é™¤æ‰€æœ‰èˆŠçš„ä¸»é¡Œé¡åˆ¥
        card.classList.remove('card-theme-1', 'card-theme-2', 'card-theme-3', 'card-theme-4', 'card-theme-5', 'card-theme-6', 'card-theme-7', 'card-theme-8', 'card-theme-9');
        // æ·»åŠ ä¿å­˜çš„ä¸»é¡Œ
        card.classList.add('card-theme-' + themeNumber);
        console.log('Applied saved theme: card-theme-' + themeNumber);
        console.log('Card classes:', card.className);
      } else {
        console.error('Card element not found during init!');
      }

      // åˆå§‹åŒ–æ™‚ä¹Ÿè¦åŒæ­¥æ•´é é è¦½ä¸»é¡Œ
      //ï¼ˆæ³¨æ„ï¼šcommon.js æœƒå…ˆå¥—ç”¨ body.theme-1~5ï¼›é€™è£¡ä»¥ cardTheme ç‚ºæº–è¦†è“‹æˆ body.card-theme-*ï¼‰
      document.body.classList.remove('theme-1', 'theme-2', 'theme-3', 'theme-4', 'theme-5', 'theme-6', 'theme-7', 'theme-8', 'theme-9');
      document.body.classList.remove('card-theme-1', 'card-theme-2', 'card-theme-3', 'card-theme-4', 'card-theme-5', 'card-theme-6', 'card-theme-7', 'card-theme-8', 'card-theme-9');
      document.body.classList.add('card-theme-' + themeNumber);
      document.body.classList.remove('theme-dark', 'theme-light');
      document.body.classList.add((themeNumber === 2 || themeNumber === 7 || themeNumber === 9) ? 'theme-light' : 'theme-dark');
      
      // å»¶é²æ›´æ–° active ç‹€æ…‹ï¼Œç¢ºä¿ modal DOM å·²è¼‰å…¥
      setTimeout(function() {
        updateThemePreviewActive(themeNumber);
      }, 200);
    }
  } else {
    console.log('No saved theme found, using default');

    // æ²’æœ‰ä¿å­˜ä¸»é¡Œæ™‚ï¼Œä»ç¢ºä¿æœ‰ä¸€å€‹å¯é æœŸçš„æ˜æš— classï¼ˆé¿å…æ¨¡æ…‹æ¡†é¡è‰²éŒ¯äº‚ï¼‰
    if (!document.body.classList.contains('theme-dark') && !document.body.classList.contains('theme-light')) {
      document.body.classList.add('theme-dark');
    }
  }
}

// é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(initCardTheme, 100);
  });
} else {
  setTimeout(initCardTheme, 100);
}

// æ›´æ–°åœ°å€é è¦½
function updateAddressPreview(addressType, zhAddress, enAddress) {
  const typeCapitalized = addressType.charAt(0).toUpperCase() + addressType.slice(1);
  const zhEl = document.getElementById(`preview${typeCapitalized}Zh`);
  const enEl = document.getElementById(`preview${typeCapitalized}En`);
  
  if (zhEl) {
    const textEl = zhEl.querySelector('.address-text');
    if (textEl) {
      textEl.textContent = zhAddress || 'ï¼ˆæœªè¨­å®šï¼‰';
    }
  }
  
  if (enEl) {
    const textEl = enEl.querySelector('.address-text');
    if (textEl) {
      textEl.textContent = enAddress || 'ï¼ˆNot Setï¼‰';
    }
  }
  
  // æ›´æ–°åœ°åœ–é€£çµ
  updateMapLink(addressType, zhAddress || enAddress);
}

// ç”Ÿæˆåœ°åœ–é€£çµ
function generateMapLink() {
  const addressType = window.currentAddressType;
  const zhAddress = document.getElementById('addressEditZh').value.trim();
  const enAddress = document.getElementById('addressEditEn').value.trim();
  
  const address = zhAddress || enAddress;
  if (!address) {
    const zhElements = document.querySelectorAll('.lang-zh');
    const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
    alert(currentLang === 'zh' ? 'è«‹å…ˆè¼¸å…¥åœ°å€' : 'Please enter address first');
    return;
  }
  
  // ç”Ÿæˆ Google Maps é€£çµ
  const encodedAddress = encodeURIComponent(address);
  const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
  
  const mapLink = document.getElementById('addressMapLink');
  if (mapLink) {
    mapLink.href = mapUrl;
    mapLink.style.display = 'inline-block';
  }
  
  // åœ¨æ–°è¦–çª—é–‹å•Ÿåœ°åœ–
  window.open(mapUrl, '_blank');
}

// æ›´æ–°åœ°åœ–é€£çµ
function updateMapLink(addressType, address) {
  if (!address || address === 'ï¼ˆæœªè¨­å®šï¼‰' || address === 'ï¼ˆNot Setï¼‰') return;
  
  const encodedAddress = encodeURIComponent(address);
  const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
  
  const typeCapitalized = addressType.charAt(0).toUpperCase() + addressType.slice(1);
  const zhEl = document.getElementById(`preview${typeCapitalized}Zh`);
  const enEl = document.getElementById(`preview${typeCapitalized}En`);
  
  [zhEl, enEl].forEach(el => {
    if (el) {
      const mapLink = el.querySelector('.address-map-link');
      if (mapLink) {
        mapLink.onclick = function(e) {
          e.stopPropagation();
          window.open(mapUrl, '_blank');
        };
      }
    }
  });
}

// é–‹å•Ÿåœ°åœ–
function openMap(addressType, event) {
  event.stopPropagation();
  event.preventDefault();
  
  const typeCapitalized = addressType.charAt(0).toUpperCase() + addressType.slice(1);
  const zhEl = document.getElementById(`preview${typeCapitalized}Zh`);
  const enEl = document.getElementById(`preview${typeCapitalized}En`);
  
  const address = zhEl?.querySelector('.address-text')?.textContent || enEl?.querySelector('.address-text')?.textContent || '';
  
  if (address && address !== 'ï¼ˆæœªè¨­å®šï¼‰' && address !== 'ï¼ˆNot Setï¼‰') {
    const encodedAddress = encodeURIComponent(address);
    const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
    window.open(mapUrl, '_blank');
  }
}

// ç·¨è¼¯åœ°å€ï¼ˆé»æ“Šåœ°å€é …ç›®æ™‚ï¼‰
function editAddress(addressType, event) {
  event.preventDefault();
  event.stopPropagation();
  showAddressEditModal(addressType);
}

// ç·¨è¼¯çµ±ä¸€ç·¨è™Ÿ
function editTaxId(event) {
  event.preventDefault();
  event.stopPropagation();
  const zhInput = document.getElementById('previewTaxIdZh');
  if (zhInput) {
    setTimeout(() => {
      zhInput.focus();
      const range = document.createRange();
      range.selectNodeContents(zhInput);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
    }, 100);
  }
}

// åˆªé™¤å…¬å¸è³‡è¨Šé …ç›®
function deleteCompanyInfo(type) {
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  
  const confirmMsg = currentLang === 'zh' ? 'ç¢ºå®šè¦åˆªé™¤æ­¤é …ç›®å—ï¼Ÿ' : 'Are you sure you want to delete this item?';
  if (!confirm(confirmMsg)) return;
  
  const itemId = type + 'Item';
  const item = document.getElementById(itemId);
  if (item) {
    item.style.display = 'none';
    
    // æ¸…é™¤å…§å®¹
    if (type === 'taxId') {
      document.getElementById('previewTaxIdZh').textContent = '';
      document.getElementById('previewTaxIdEn').textContent = '';
    } else {
      const typeCapitalized = type.charAt(0).toUpperCase() + type.slice(1);
      const zhEl = document.getElementById(`preview${typeCapitalized}Zh`);
      const enEl = document.getElementById(`preview${typeCapitalized}En`);
      if (zhEl) {
        const textEl = zhEl.querySelector('.address-text');
        if (textEl) textEl.textContent = '';
      }
      if (enEl) {
        const textEl = enEl.querySelector('.address-text');
        if (textEl) textEl.textContent = '';
      }
    }
  }
}

// æ·»åŠ è¯çµ¡æ–¹å¼æŒ‰éˆ•åˆ°é è¦½å€åŸŸ
function addContactButtonToPreview(type, newLink, buttonTextZh, buttonTextEn) {
  // é˜²æ­¢é‡è¤‡æ·»åŠ  - æª¢æŸ¥æ˜¯å¦å·²ç¶“å­˜åœ¨ç›¸åŒçš„é€£çµ
  const contactsGroup = document.getElementById('previewContacts');
  if (contactsGroup) {
    const existingButtons = contactsGroup.querySelectorAll(`a[href="${newLink}"]`);
    if (existingButtons.length > 0) {
      console.log('Contact with this link already exists, skipping duplicate');
      return;
    }
  }
  
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  
  if (!contactsGroup) {
    console.error('previewContacts element not found');
    alert(currentLang === 'zh' ? 'æ‰¾ä¸åˆ°è¯çµ¡æ–¹å¼å®¹å™¨' : 'Contact container not found');
    return;
  }
  
  // å‰µå»ºä¸­æ–‡æŒ‰éˆ•
  const btnZh = document.createElement('a');
  btnZh.className = 'btn btn-secondary lang-zh edit-clickable';
  btnZh.href = newLink;
  if (type === 'website' || type === 'line' || type === 'official-line' || type === 'facebook' || type === 'instagram' || type === 'linkedin' || type === 'twitter' || type === 'youtube' || type === 'whatsapp') {
    btnZh.target = '_blank';
  }
  if (type === 'vcf') {
    btnZh.download = 'Contact.vcf';
  }
  btnZh.innerHTML = buttonTextZh;
  btnZh.onclick = function(event) {
    editContact(event, type, newLink);
  };
  
  // å‰µå»ºè‹±æ–‡æŒ‰éˆ•
  const btnEn = document.createElement('a');
  btnEn.className = 'btn btn-secondary lang-en edit-clickable';
  btnEn.href = newLink;
  if (type === 'website' || type === 'line' || type === 'official-line' || type === 'facebook' || type === 'instagram' || type === 'linkedin' || type === 'twitter' || type === 'youtube' || type === 'whatsapp') {
    btnEn.target = '_blank';
  }
  if (type === 'vcf') {
    btnEn.download = 'Contact.vcf';
  }
  btnEn.innerHTML = buttonTextEn;
  btnEn.onclick = function(event) {
    editContact(event, type, newLink);
  };
  
  // å‰µå»ºåŒ…è£å™¨
  const wrapper = document.createElement('div');
  wrapper.className = 'contact-btn-wrapper';
  
  wrapper.appendChild(btnZh);
  wrapper.appendChild(btnEn);
  
  // å‰µå»ºåˆªé™¤æŒ‰éˆ•
  const deleteBtn = document.createElement('button');
  deleteBtn.className = 'contact-delete-btn';
  deleteBtn.textContent = 'âœ•';
  deleteBtn.title = currentLang === 'zh' ? 'åˆªé™¤' : 'Delete';
  deleteBtn.onclick = function(event) {
    event.stopPropagation();
    deleteContactButton(btnZh);
  };
  wrapper.appendChild(deleteBtn);
  
  // æ·»åŠ åˆ°è¯çµ¡æ–¹å¼å®¹å™¨
  contactsGroup.appendChild(wrapper);
  console.log('Contact button added to previewContacts');
}

// åˆ‡æ›è¯çµ¡æ–¹å¼é …ç›®å±•é–‹/æ”¶åˆ
function toggleContactItem(btn) {
  const item = btn.closest('.edit-contact-item');
  const content = item.querySelector('.edit-contact-content');
  const arrow = btn.querySelector('.edit-contact-toggle-arrow');
  
  content.classList.toggle('show');
  arrow.classList.toggle('expanded');
}

// åˆ‡æ›å¯è¦‹æ€§è¨­å®šå±•é–‹/æ”¶åˆ
function toggleVisibility(btn) {
  const content = btn.nextElementSibling;
  const arrow = btn.querySelector('.edit-contact-visibility-arrow');
  
  content.classList.toggle('show');
  arrow.classList.toggle('expanded');
}


// ç§»å‹•è¯çµ¡æ–¹å¼
function moveContact(item, direction) {
  if (typeof item === 'object' && item.nodeName) {
    // å¦‚æœå‚³å…¥çš„æ˜¯ DOM å…ƒç´ 
  } else {
    // å¦‚æœå‚³å…¥çš„æ˜¯æŒ‰éˆ•
    item = item.closest('.edit-contact-item');
  }
  const list = item.parentElement;
  if (direction === 'up' && item.previousElementSibling) {
    list.insertBefore(item, item.previousElementSibling);
  } else if (direction === 'down' && item.nextElementSibling) {
    list.insertBefore(item.nextElementSibling, item);
  }
}

// åˆªé™¤è¯çµ¡æ–¹å¼æŒ‰éˆ•ï¼ˆå¾é è¦½å€åŸŸï¼‰
function deleteContactButton(contactBtn) {
  if (event) event.stopPropagation();
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';
  const confirmMsg = currentLang === 'zh' ? 'ç¢ºå®šè¦åˆªé™¤æ­¤è¯çµ¡æ–¹å¼å—ï¼Ÿ' : 'Are you sure you want to delete this contact method?';
  
  if (confirm(confirmMsg)) {
    // æ‰¾åˆ°å°æ‡‰çš„åŒ…è£å™¨ä¸¦åˆªé™¤ï¼ˆåŒ…å«ä¸­æ–‡å’Œè‹±æ–‡æŒ‰éˆ•ï¼‰
    const wrapper = contactBtn.closest('.contact-btn-wrapper');
    if (wrapper) {
      wrapper.remove();
    }
  }
}

// å„²å­˜åç‰‡ï¼ˆé›²ç«¯ï¼šSupabaseï¼‰
async function saveCard() {
  const zhElements = document.querySelectorAll('.lang-zh');
  const currentLang = zhElements.length > 0 && zhElements[0].style.display !== 'none' ? 'zh' : 'en';

  function textOf(id) {
    const el = document.getElementById(id);
    return String(el?.textContent || '').replace(/\s+/g, ' ').trim();
  }

  // åŸºæœ¬æ¬„ä½ï¼šç¬¦åˆä½ è¦åŒ¯å‡ºçš„æ¬„ä½ï¼ˆname/phone/email/company/title/theme/created_at/updated_atï¼‰
  const name = textOf('previewNameZh') || textOf('previewNameEn') || '';
  const title = textOf('previewTitleZh') || textOf('previewTitleEn') || '';
  const theme = (function () {
    // å„ªå…ˆï¼šbody.card-theme-*
    const cls = Array.from(document.body.classList || []);
    const hit = cls.find(c => /^card-theme-\d+$/.test(c));
    if (hit) return parseInt(hit.replace('card-theme-', ''), 10) || 1;
    // æ¬¡é¸ï¼šlocalStorage cardTheme
    try { return parseInt(localStorage.getItem('cardTheme') || '1', 10) || 1; } catch (e) { return 1; }
  })();

  const phone = (function () {
    const a = document.querySelector('a[href^="tel:"]');
    return a ? String(a.getAttribute('href') || '').replace(/^tel:/i, '').trim() : '';
  })();

  const email = (function () {
    const a = document.querySelector('a[href^="mailto:"]');
    return a ? String(a.getAttribute('href') || '').replace(/^mailto:/i, '').trim() : '';
  })();

  const company = (function () {
    // ç›¡é‡å¾å¯ç·¨è¼¯æ¬„ä½ä¸­æŠ“å…¬å¸å­—æ¨£ï¼›è‹¥æ²’æœ‰å°±ç•™ç©ºï¼ˆä»å¯ç”¨ profile_json å®Œæ•´ä¿å­˜ï¼‰
    const el = document.querySelector('[data-field="company"], #previewCompany, #companyName');
    return el ? String(el.textContent || el.value || '').trim() : '';
  })();

  // å®Œæ•´è³‡æ–™ï¼šå…ˆç”¨ profile_json ä¿å­˜ç›®å‰é è¦½å€å…§å®¹ï¼ˆä¸æ”¹ UI çµæ§‹ï¼‰
  const profile_json = (function () {
    const card = document.getElementById('previewCard');
    const logo = document.getElementById('previewLogo');
    const avatar = document.getElementById('previewAvatar');
    const contacts = document.getElementById('previewContacts');
    const companyInfo = document.getElementById('companyInfoSection');
    return {
      lang: currentLang,
      nameZh: textOf('previewNameZh'),
      nameEn: textOf('previewNameEn'),
      titleZh: textOf('previewTitleZh'),
      titleEn: textOf('previewTitleEn'),
      theme: theme,
      logoSrc: String(logo?.getAttribute('src') || ''),
      avatarSrc: String(avatar?.getAttribute('src') || ''),
      previewCardHtml: card ? card.innerHTML : '',
      contactsHtml: contacts ? contacts.innerHTML : '',
      companyInfoHtml: companyInfo ? companyInfo.innerHTML : '',
      savedAt: new Date().toISOString()
    };
  })();

  // é›²ç«¯å„²å­˜ï¼šè‹¥æœªè¨­å®š Supabaseï¼Œä»å…è¨±é›¢ç·šå„²å­˜æç¤º
  if (!window.UVACO_CLOUD || !UVACO_CLOUD.hasConfig()) {
    alert(currentLang === 'zh' ? 'åç‰‡å·²å„²å­˜ï¼ˆé›¢ç·šæ¨¡å¼ï¼‰' : 'Saved (offline mode)');
    try { localStorage.setItem('UVACO_ONBOARDED', '1'); } catch (e) {}
    return;
  }

  // éœ€ç™»å…¥
  const here = 'edit.html' + (window.location.search || '');
  const auth = await UVACO_CLOUD.requireAuth(here);
  if (!auth.ok) return;

  // åˆè¦ï¼šé¦–æ¬¡/ç‰ˆæœ¬è®Šæ›´éœ€è¦åŒæ„ï¼ˆä»¥ confirm æœ€å°åŒ– UI è®Šæ›´ï¼‰
  const params = new URLSearchParams(window.location.search || '');
  const consentVersion = 'v1.0';
  const policyUrl = (UVACO_CLOUD.getBaseUrl ? UVACO_CLOUD.getBaseUrl() : '') + 'privacy.html';
  const needConfirm = params.get('mode') === 'onboarding';
  if (needConfirm) {
    const ok = confirm(
      currentLang === 'zh'
        ? 'å„²å­˜å‰è«‹å…ˆåŒæ„éš±ç§æ¬Šæ”¿ç­–ï¼ˆv1.0ï¼‰ã€‚\næŒ‰ã€Œç¢ºå®šã€ä»£è¡¨ä½ å·²é–±è®€ä¸¦åŒæ„ã€‚'
        : 'Please agree to the Privacy Policy (v1.0) before saving.\nClick OK to continue.'
    );
    if (!ok) return;
  }

  try {
    // å¯«å…¥åŒæ„ç´€éŒ„ï¼ˆè‹¥å·²åŒæ„åŒç‰ˆæœ¬å‰‡æœƒç•¥éï¼‰
    await UVACO_CLOUD.ensureConsent(consentVersion, policyUrl);
    await UVACO_CLOUD.upsertMyCard({ name, phone, email, company, title, theme, profile_json });

    alert(currentLang === 'zh' ? 'åç‰‡å·²å„²å­˜ï¼' : 'Business card saved!');
    try { localStorage.setItem('UVACO_ONBOARDED', '1'); } catch (e) {}

    // onboarding æ¨¡å¼ï¼šå„²å­˜å¾Œå°å›æŒ‡å®šé ï¼ˆé è¨­å›é€šè¨ŠéŒ„ï¼‰
    if (params.get('mode') === 'onboarding') {
      const next = params.get('next') || 'directory.html';
      const safe = /^[a-z0-9_\\-\\/]+\\.html(\\?.*)?$/i.test(next) ? next : 'directory.html';
      window.location.href = safe;
      return;
    }
  } catch (e) {
    alert(currentLang === 'zh' ? 'å„²å­˜å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚' : 'Save failed. Please try again.');
  }
}


</script>

</body>
</html>

